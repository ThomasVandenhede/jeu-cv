{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./js/utils.js","webpack:///./js/game/player.js","webpack:///./js/game/platform.js","webpack:///./js/game/particleEmitters.js","webpack:///./js/game/ennemy.js","webpack:///./js/game/movingPlatform.js","webpack:///./js/game/skills.js","webpack:///./js/game/levelManager.js","webpack:///./js/game/shield.js","webpack:///./js/game/smokeParticle.js","webpack:///./js/game/laser.js","webpack:///./js/game/skill.js","webpack:///./js/index.js","webpack:///./js/game/game.js","webpack:///./js/game/gameMenu.js","webpack:///./js/game/collisionManager.js","webpack:///./js/game/lifebar.js","webpack:///./js/game/skillBar.js","webpack:///./js/game/ghost.js","webpack:///./js/game/clock.js","webpack:///./js/game/clockDisplay.js"],"names":["enumerable","get","getter","value","key","bind","module","Object","prototype","hasOwnProperty","call","object","property","id","exports","toFixedPrecision","number","precision","toFixed","noop","randInt","start","end","Math","floor","random","lerp","v0","v1","t","show","el","classList","remove","hide","add","incrementID","render","vdom","renderNode","vnode","document","createTextNode","element","createElement","type","props","keys","forEach","setAttribute","eventType","substring","addEventListener","children","childNode","undefined","appendChild","h","vNode","arguments","Array","slice","length","reduce","acc","item","isArray","concat","emptyElement","firstChild","removeChild","Shield","particleEmitters","utils","INITIAL_WIDTH","INITIAL_HEIGHT","Player","SDK","Rectangle","this","x","y","width","height","ABS_HORIZONTAL_MAX_SPEED","v","Vector","acceleration","solid","maxHitPoints","hitPoints","skills","color","getColorFromHP","isColliding","collidableWith","collidingWith","shield","shielded","sounds","jump","Sound","hit","still","die","hurt","stickyJump","GRAVITY_ACCELERATION","gameData","constants","create","constructor","moveLeft","moveRight","sign","sparks","sparksParticles","replay","reverseGravity","zeroGravity","applyDamage","damage","cb","isDead","stop","play","explosion","explosionParticles","applyGravity","dt","abs","update","dx","dy","getHitPointsRatio","draw","ctx","camera","center","save","strokeStyle","fillStyle","lineWidth","applyToDistance","fillRect","applyToX","applyToY","left","top","beginPath","moveTo","quadraticCurveTo","closePath","fill","restore","isOpen","isAnimating","Platform","passthrough","touched","rect","stroke","strokeRect","SmokeParticle","gameObj","Date","now","particleIndex","particles","minSpeed","maxSpeed","maxSize","minSize","maxLife","duration","addNewParticle","size","hasWon","particle","right","vx","vy","bottom","i","createdAt","j","Particle","hitParticles","direction","getUnitVector","scale","rotateRadians","PI","circle","Laser","Ennemy","Circle","fireDelay","visionRange","attackRange","lasers","lastFiredAt","Number","NEGATIVE_INFINITY","attack","range","updateVelocity","arc","r","MovingPlatform","xStart","yStart","xEnd","yEnd","speed","vNorm","norm","Skill","SkillHtml","assign","src","SkillCss","SkillSass","SkillBootstrap","SkillJquery","SkillReact","SkillAngular","SkillNode","SkillMeteor","SkillMongo","LevelManager","level","gameEntityConstructors","data","app","buildLevel","name","levels","levelData","worldRectData","worldRect","playerData","player","platformsData","platforms","ennemiesData","ennemies","skillsData","countdownStart","platform","push","ennemy","skill","buildEntities","extra","entities","deleteLevel","MIN_SIZE","openingDuration","closingDuration","open","close","getBoundingRect","dr","hasCollisionWithLaser","laser","boundingRect","collision","physics","RectangleWithRectangle","c1","c2","c3","c4","r1","r2","containsPoint","A","B","contains","arcTo","lineTo","image","Image","globalAlpha","max","drawImage","sum","Segment","origin","subtract","hasReachedMaxRange","normSquared","pow","dPos","Game","window","documentElement","requestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen","canvases","getElementsByTagName","startGameButton","getElementById","resize","canvas","canvasWidth","parseFloat","getComputedStyle","canvasHeight","e","preventDefault","returnValue","game","displayRulers","displayDebug","setInterval","updateDebugInfo","GameMenu","CollisionManager","LifeBar","SkillBar","Ghost","Clock","ClockDisplay","config","pause","introContainer","gameContainer","debugIntervalID","gameMenu","state","states","PAUSED","levelManager","currentLevelName","grid","Grid","options","isGame","mouse","ghost","clock","clockDisplay","RUNNING","GAME_OVER","VICTORY","EXIT","loadGameDataFromLocalStorage","savedData","localStorage","getItem","JSON","parse","preload","images","args","remainingCount","lastArgument","done","source","onload","handleKeyboard","keyboard","touchInput","ArrowRight","isPressed","JOYPAD_RIGHT","ArrowLeft","JOYPAD_LEFT","ArrowDown","JOYPAD_DOWN","ArrowUp","JOYPAD_UP","Space","BUTTON_A","Enter","BUTTON_B","Equal","zoomIn","Minus","zoomOut","runPhysics","distanceVector","index","collisionManager","destroyLaser","splice","within","timeRemaining","checkVictory","checkDefeat","updateDimensions","setBackground","path","style","backgroundImage","backgroundSize","pauseLoop","frame","cancelAnimationFrame","exit","gameContainerEl","unbindEventHandlers","gameMenuEl","showPauseMenu","soundManager","pauseAll","unpause","playPaused","displaySplash","hideSplash","setTimeout","init","step","restart","reset","timer","follow","lifeBar","gameObject","skillBar","Pause","onDown","repeat","KeyG","handleCollisions","showVictoryMenu","showGameOverMenu","clearCanvas","renderBackground","renderScene","renderUI","clearRect","backgroundPosition","entity","uiElements","uiElement","debugContainerEl","debugEl","class","isCrouching","uiContainerEl","gameIntroEl","resumeButtonVNode","href","onclick","event","onkeyup","keyCode","target","click","restartButtonVNode","controlsButtonVNode","showControlsMenu","aboutButtonVNode","showAboutMenu","backButtonVNode","loadButtonVNode","showLoadMenu","editorButtonVNode","exitButtonVNode","exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen","showMenu","map","querySelector","handleCollisionsWithPlatforms","handleCollisionsWithSkills","handleCollisionsWithLasers","playerBox","laserBox","segmentRectangle","POSITIVE_INFINITY","skillBox","countdownDuration","getCollidablePlatformsInViewport","filter","box","overlaps","getCollisions","collidableGameObjects","collisions","md","minkowskiDifference","relMotion","colInfo","side","d","boxH","boxV","dH","dV","hitPointsRation","font","textAlign","fontWeight","fillText","ceil","acquiredSkillsCount","totalSkillsCount","ghostIndex","ghostPositions","ghostPositionsTemp","time","timeEllapsed","isPaused","hasMilliseconds","isCountDown","defineProperties","currentTime","previousTime","initialDuration","getValues","milliseconds","seconds","minutes","hours","round","values","ms","getTime","SECONDS_IN_ONE_MINUTE","MINUTES_IN_ONE_HOUR","days","HOURS_IN_ONE_DAY","DANGER_COUNTDOWN_TIME","timerEl","getText","textArr","toString","padStart","join","text","textContent","innerHTML"],"mappings":"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","file":"game.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 43);\n","module.exports = {\n  toFixedPrecision: function(number, precision) {\n    return +number.toFixed(precision || 0);\n  },\n\n  noop: function() {},\n\n  randInt: function(start, end) {\n    return Math.floor(Math.random() * (end - start + 1) + start);\n  },\n\n  lerp: function(v0, v1, t) {\n    return (1 - t) * v0 + t * v1;\n  },\n\n  show: function(el) {\n    el.classList.remove(\"hidden\");\n  },\n\n  hide: function(el) {\n    el.classList.add(\"hidden\");\n  },\n\n  incrementID: (function() {\n    var id = -1;\n    return function() {\n      id = id + 1;\n      return id;\n    };\n  })(),\n\n  // h: function(type, props, children) {\n  //   var el = document.createElement(type);\n  //   var nodes, node;\n  //   for (var key in props) {\n  //     el.setAttribute(key, props[key]);\n  //   }\n  //   if (Array.isArray(children)) {\n  //     nodes = children;\n  //   } else {\n  //     nodes = [children];\n  //   }\n  //   for (var i = 0; i < nodes.length; i++) {\n  //     if (typeof nodes[i] === \"string\") {\n  //       node = document.createTextNode(nodes[i]);\n  //     } else {\n  //       node = nodes[i];\n  //     }\n  //     el.appendChild(node);\n  //   }\n  //   return el;\n  // },\n\n  render: function(vdom) {\n    return (function renderNode(vnode) {\n      // vnode is a string\n      if (typeof vnode === \"string\" || typeof vnode === \"number\")\n        return document.createTextNode(vnode);\n\n      var element = document.createElement(vnode.type);\n      var props = vnode.props || {};\n\n      Object.keys(props).forEach(function(key) {\n        // treat events separately\n        if (typeof props[key] !== \"function\") {\n          element.setAttribute(key, props[key]);\n        }\n\n        // events\n        if (typeof props[key] === \"function\") {\n          var eventType = key.substring(2); // remove the 'on' part\n          element.addEventListener(eventType, props[key]);\n        }\n      });\n\n      (vnode.children || []).forEach(function(childNode) {\n        if (childNode === undefined) return;\n        return element.appendChild(renderNode(childNode));\n      });\n      return element;\n    })(vdom);\n  },\n\n  h: function() {\n    var vNode = {};\n    var type = arguments[0];\n    var props = arguments[1];\n    var children = Array.prototype.slice.call(arguments, 2);\n\n    vNode.type = type;\n    vNode.props = props;\n    if (children.length) {\n      vNode.children = children.reduce(function(acc, item) {\n        return Array.isArray(item) ? acc.concat(item) : acc.concat(item);\n      }, []);\n    } else {\n      vNode.children = null;\n    }\n\n    return vNode;\n  },\n\n  emptyElement: function(el) {\n    while (el.firstChild) {\n      el.removeChild(el.firstChild);\n    }\n  }\n};\n","var Shield = require(\"./shield\");\nvar particleEmitters = require(\"./particleEmitters\");\nvar utils = require(\"../utils\");\n\nvar ABS_JUMP_SPEED = 700;\nvar MAX_FALL_SPEED = 1000;\nvar INITIAL_WIDTH = 30;\nvar INITIAL_HEIGHT = 30;\n\nfunction Player(props) {\n  SDK.Rectangle.call(this, {\n    x: props.x,\n    y: props.y,\n    width: INITIAL_WIDTH,\n    height: INITIAL_HEIGHT\n  });\n\n  this.ABS_HORIZONTAL_MAX_SPEED = 250;\n  this.v = new SDK.Vector();\n  this.acceleration = new SDK.Vector();\n  this.solid = true; // can collide with other solid objects\n  this.maxHitPoints = 100;\n  this.hitPoints = this.maxHitPoints;\n  this.skills = []; // the player must harvest these\n  this.color = this.getColorFromHP();\n\n  // collision direction for movement\n  this.isColliding = [0, 0]; // [horizontal, vertical]\n  this.collidableWith = []; // potential object collisions\n  this.collidingWith = [null, null]; // actual object collisions\n  this.shield = new Shield({ shielded: this });\n\n  // sounds\n  this.sounds = {\n    jump: [\n      // new SDK.Sound(\"./assets/sounds/Swoosh1.mp3\", 0.25),\n      new SDK.Sound(\"./assets/sounds/Swoosh2.mp3\", 0.1),\n      new SDK.Sound(\"./assets/sounds/Swoosh3.mp3\", 0.3)\n    ],\n    hit: [\n      new SDK.Sound(\"./assets/sounds/Hit 1.mp4\", 0.2),\n      new SDK.Sound(\"./assets/sounds/Hit 2.mp4\", 0.2)\n    ],\n    still: new SDK.Sound(\"./assets/sounds/Medium hum.mp4\", 0.15),\n    die: new SDK.Sound(\"./assets/sounds/impactsplat03.mp3\", 0.8),\n    hurt: new SDK.Sound(\"./assets/sounds/Knife Stab.mp3\", 0.2)\n  };\n\n  // should the player get stuck to the ceiling when jumping?\n  this.stickyJump = false;\n\n  // player's own gravity\n  this.GRAVITY_ACCELERATION = gameData.constants.GRAVITY_ACCELERATION;\n}\n\nPlayer.prototype = Object.create(SDK.Rectangle.prototype);\nPlayer.prototype.constructor = Player;\n\nPlayer.prototype.moveLeft = function() {\n  this.v.x -= this.ABS_HORIZONTAL_MAX_SPEED;\n};\n\nPlayer.prototype.moveRight = function() {\n  this.v.x += this.ABS_HORIZONTAL_MAX_SPEED;\n};\n\nPlayer.prototype.jump = function() {\n  if (this.isColliding[1] === Math.sign(this.GRAVITY_ACCELERATION)) {\n    // emit particles\n    this.sparks = particleEmitters.sparksParticles(this);\n\n    this.sounds.jump[utils.randInt(0, this.sounds.jump.length - 1)].replay();\n    this.isColliding[1] = 0;\n    this.v.y = -Math.sign(this.GRAVITY_ACCELERATION) * ABS_JUMP_SPEED;\n  }\n};\n\nPlayer.prototype.reverseGravity = function() {\n  this.GRAVITY_ACCELERATION = -this.GRAVITY_ACCELERATION;\n};\n\nPlayer.prototype.zeroGravity = function() {\n  if (this.GRAVITY_ACCELERATION) {\n    this.GRAVITY_ACCELERATION = 0;\n  } else {\n    this.GRAVITY_ACCELERATION = gameData.constants.GRAVITY_ACCELERATION;\n  }\n};\n\nPlayer.prototype.applyDamage = function(damage) {\n  this.sounds.hurt.replay();\n  this.hitPoints = utils.toFixedPrecision(this.hitPoints - damage);\n};\n\nPlayer.prototype.die = function(cb) {\n  this.isDead = true;\n  this.hitPoints = 0;\n  this.color = this.getColorFromHP();\n  this.sounds.still.stop();\n  this.sounds.die.play();\n  this.explosion = particleEmitters.explosionParticles(this);\n  cb && cb();\n};\n\nPlayer.prototype.applyGravity = function() {\n  // apply gravity if player is free falling\n  this.acceleration.y = this.GRAVITY_ACCELERATION;\n\n  // compute new speed based on acceleration and time ellapsed\n  this.v.y += this.acceleration.y * dt;\n  this.v.y =\n    Math.abs(this.v.y) > MAX_FALL_SPEED\n      ? Math.sign(this.v.y) * MAX_FALL_SPEED\n      : this.v.y;\n};\n\nPlayer.prototype.update = function() {\n  if (this.isDead) {\n    this.explosion.update();\n    return;\n  } else {\n    this.sparks && this.sparks.update();\n  }\n\n  var dx = this.v.x * dt,\n    dy = this.v.y * dt;\n\n  // apply natural position increments if no collision detected\n  if (!this.isColliding[1]) {\n    this.y = utils.toFixedPrecision(this.y + dy, 4);\n  }\n  if (!this.isColliding[0]) {\n    this.x = utils.toFixedPrecision(this.x + dx, 4);\n  }\n};\n\nPlayer.prototype.getHitPointsRatio = function() {\n  return this.hitPoints / this.maxHitPoints;\n};\n\nPlayer.prototype.getColorFromHP = function() {\n  var hitPointsRatio = this.getHitPointsRatio();\n  var color = \"hsl(\" + hitPointsRatio * 120 + \", 100%, 50%)\";\n  return color;\n};\n\nPlayer.prototype.draw = function(ctx, camera) {\n  // draw particles\n  this.color = this.getColorFromHP();\n  this.isDead && this.explosion.draw(ctx, camera);\n  !this.isDead && this.sparks && this.sparks.draw(ctx, camera);\n\n  // draw player\n  if (!this.isDead) {\n    var center = this.center;\n    var lineWidth = 5;\n\n    ctx.save();\n    ctx.strokeStyle = this.color;\n    ctx.fillStyle = this.color;\n    ctx.lineWidth = camera.applyToDistance(lineWidth);\n    ctx.fillRect(\n      camera.applyToX(this.x),\n      camera.applyToY(this.y),\n      camera.applyToDistance(this.width),\n      camera.applyToDistance(this.height)\n    );\n\n    // draw mask\n    ctx.fillStyle = \"black\";\n    ctx.fillRect(\n      camera.applyToX(this.left),\n      camera.applyToY(this.top + 10),\n      camera.applyToDistance(this.width),\n      camera.applyToDistance(10)\n    );\n\n    // draw eyes\n    ctx.fillStyle = this.color;\n    ctx.beginPath();\n    ctx.moveTo(camera.applyToX(center.x - 10), camera.applyToY(this.top + 12));\n    ctx.quadraticCurveTo(\n      camera.applyToX(center.x - 4),\n      camera.applyToY(this.top + 14),\n      camera.applyToX(center.x - 4),\n      camera.applyToY(this.top + 16)\n    );\n    ctx.quadraticCurveTo(\n      camera.applyToX(center.x - 10),\n      camera.applyToY(this.top + 16),\n      camera.applyToX(center.x - 10),\n      camera.applyToY(this.top + 14)\n    );\n    ctx.closePath();\n    ctx.fill();\n    ctx.beginPath();\n    ctx.moveTo(camera.applyToX(center.x + 10), camera.applyToY(this.top + 12));\n    ctx.quadraticCurveTo(\n      camera.applyToX(center.x + 4),\n      camera.applyToY(this.top + 14),\n      camera.applyToX(center.x + 4),\n      camera.applyToY(this.top + 16)\n    );\n    ctx.quadraticCurveTo(\n      camera.applyToX(center.x + 10),\n      camera.applyToY(this.top + 16),\n      camera.applyToX(center.x + 10),\n      camera.applyToY(this.top + 14)\n    );\n    ctx.closePath();\n    ctx.fill();\n    ctx.restore();\n\n    // draw shield\n    if (this.shield.isOpen || this.shield.isAnimating) {\n      this.shield.draw(ctx, camera);\n    }\n  }\n};\n\nmodule.exports = Player;\n","var Platform = (function() {\n  var MAX_SPEED = 100;\n\n  function Platform(props) {\n    SDK.Rectangle.call(this, props);\n\n    this.v = new SDK.Vector();\n    this.solid = props && props.solid !== undefined ? props.solid : true; // can collide with other solid objects\n    this.passthrough =\n      props && props.passthrough !== undefined ? props.passthrough : false; // can it be traversed upwards\n    this.touched = false; // is the player touching the platform\n    this.color = \"#5e4c4c\";\n  }\n\n  Platform.prototype = Object.create(SDK.Rectangle.prototype);\n  Platform.prototype.constructor = Platform;\n\n  Platform.prototype.update = function() {};\n\n  Platform.prototype.draw = function(ctx, camera) {\n    var lineWidth = 3;\n    ctx.save();\n    ctx.lineWidth = camera.applyToDistance(lineWidth);\n    if (this.touched || !this.passthrough) {\n      ctx.strokeStyle = \"#db0000\";\n      ctx.fillStyle = this.color;\n      ctx.beginPath();\n      ctx.rect(\n        camera.applyToX(this.x + lineWidth / 2),\n        camera.applyToY(this.y + lineWidth / 2),\n        camera.applyToDistance(this.width - lineWidth),\n        camera.applyToDistance(this.height - lineWidth)\n      );\n      ctx.fill();\n      ctx.stroke();\n    } else {\n      lineWidth = 3;\n      ctx.strokeStyle = this.color;\n      ctx.lineWidth = camera.applyToDistance(lineWidth);\n      ctx.beginPath();\n      ctx.strokeRect(\n        camera.applyToX(this.x + lineWidth / 2),\n        camera.applyToY(this.y + lineWidth / 2),\n        camera.applyToDistance(this.width - lineWidth),\n        camera.applyToDistance(this.height - lineWidth)\n      );\n    }\n    ctx.restore();\n  };\n\n  return Platform;\n})();\n\nmodule.exports = Platform;\n","var SmokeParticle = require(\"./smokeParticle\");\nvar utils = require(\"../utils\");\n\nvar sparksParticles = function(gameObj) {\n  var start = Date.now();\n\n  return {\n    particleIndex: 0,\n    particles: {},\n    minSpeed: 5,\n    maxSpeed: 20,\n    maxSize: 20,\n    minSize: 3,\n    maxLife: 2000,\n    duration: 200,\n    addNewParticle: function() {\n      this.particleIndex++;\n      var t = (this.duration - (Date.now() - start)) / this.duration;\n      var size = utils.lerp(this.minSize, this.maxSize, t);\n      var color = !gameObj.hasWon\n        ? gameObj.color\n        : \"rgb(\" +\n          utils.randInt(0, 255) +\n          \", \" +\n          utils.randInt(0, 255) +\n          \", \" +\n          utils.randInt(0, 255) +\n          \")\";\n      switch (utils.randInt(0, 3)) {\n        case 0:\n          // top edge\n          particle = new SmokeParticle({\n            x: utils.randInt(gameObj.left, gameObj.right),\n            y: gameObj.top - size,\n            size: size,\n            color: color,\n            vx: utils.randInt(-this.maxSpeed, this.maxSpeed),\n            vy: utils.randInt(-this.maxSpeed, -this.minSpeed),\n            maxLife: this.maxLife\n          });\n          particle.id = this.particleIndex;\n          this.particles[this.particleIndex] = particle;\n          break;\n        case 1:\n          // bottom edge\n          particle = new SmokeParticle({\n            x: utils.randInt(gameObj.left, gameObj.right),\n            y: gameObj.bottom,\n            size: size,\n            color: color,\n            vx: utils.randInt(-this.maxSpeed, this.maxSpeed),\n            vy: utils.randInt(this.minSpeed, this.maxSpeed),\n            maxLife: this.maxLife\n          });\n          particle.id = this.particleIndex;\n          this.particles[this.particleIndex] = particle;\n          break;\n        case 2:\n          // left edge\n          particle = new SmokeParticle({\n            x: gameObj.left - size,\n            y: utils.randInt(gameObj.top, gameObj.bottom),\n            size: size,\n            color: color,\n            vx: utils.randInt(-this.maxSpeed, -this.minSpeed),\n            vy: utils.randInt(-this.maxSpeed, this.maxSpeed),\n            maxLife: this.maxLife\n          });\n          particle.id = this.particleIndex;\n          this.particles[this.particleIndex] = particle;\n          break;\n        case 3:\n          // right edge\n          particle = new SmokeParticle({\n            x: gameObj.right,\n            y: utils.randInt(gameObj.top, gameObj.bottom),\n            size: size,\n            color: color,\n            vx: utils.randInt(this.minSpeed, this.maxSpeed),\n            vy: utils.randInt(-this.maxSpeed, this.maxSpeed),\n            maxLife: this.maxLife\n          });\n          particle.id = this.particleIndex;\n          this.particles[this.particleIndex] = particle;\n          break;\n      }\n    },\n    update: function() {\n      // only add particles for a certain duration\n      if (Date.now() <= start + this.duration) {\n        for (var i = 0; i < 2; i++) {\n          this.addNewParticle();\n        }\n      }\n\n      for (var id in this.particles) {\n        var particle = this.particles[id];\n        particle.update();\n        if (Date.now() - particle.createdAt >= this.maxLife) {\n          delete this.particles[id];\n        }\n      }\n    },\n    draw: function(ctx, camera) {\n      ctx.save();\n      for (var id in this.particles) {\n        var particle = this.particles[id];\n        particle.draw(ctx, camera);\n      }\n      ctx.restore();\n    }\n  };\n};\n\nvar explosionParticles = function(gameObj) {\n  var size = 5;\n  var minLife = 500;\n  var maxLife = 1500;\n  var particles = [];\n  var minSpeed = 10;\n  var maxSpeed = 50;\n  var particleIndex = 0;\n  for (var i = gameObj.left; i < gameObj.right; i += size) {\n    for (var j = gameObj.top; j < gameObj.bottom; j += size) {\n      var center = gameObj.center;\n      var v = new SDK.Vector(\n        utils.randInt(-maxSpeed * 5, maxSpeed * 5),\n        utils.randInt(\n          -Math.sign(gameObj.GRAVITY_ACCELERATION) * maxSpeed * 10,\n          -Math.sign(gameObj.GRAVITY_ACCELERATION) * minSpeed * 10\n        )\n      );\n      var particle = new SDK.Particle({\n        x: i,\n        y: j,\n        size: size,\n        color: gameObj.color,\n        vx: v.x,\n        vy: v.y,\n        maxLife: utils.randInt(minLife, maxLife)\n      });\n      particles[particleIndex] = particle;\n      particleIndex++;\n      var v = new SDK.Vector(\n        utils.randInt(-maxSpeed * 5, maxSpeed * 5),\n        utils.randInt(\n          -Math.sign(gameObj.GRAVITY_ACCELERATION) * maxSpeed * 10,\n          -Math.sign(gameObj.GRAVITY_ACCELERATION) * minSpeed * 10\n        )\n      );\n      var particle = new SDK.Particle({\n        x: i,\n        y: j,\n        size: size,\n        color: gameObj.color,\n        vx: v.x,\n        vy: v.y,\n        maxLife: utils.randInt(minLife, maxLife)\n      });\n      particles[particleIndex] = particle;\n      particleIndex++;\n    }\n  }\n  return {\n    update: function() {\n      for (var id in particles) {\n        var particle = particles[id];\n        particle.v.y += (gameObj.GRAVITY_ACCELERATION / 4) * dt;\n        particle.update();\n        if (Date.now() - particle.createdAt >= particle.maxLife) {\n          delete particles[id];\n        }\n      }\n    },\n    draw: function(ctx, camera) {\n      ctx.save();\n      for (var id in particles) {\n        var particle = particles[id];\n        particle.draw(ctx, camera);\n      }\n      ctx.restore();\n    }\n  };\n};\n\nvar hitParticles = function(x, y, direction, color) {\n  var createdAt = Date.now();\n  var particleIndex = 0;\n  var maxCount = 30;\n  var minSize = 2;\n  var maxSize = 6;\n  var minLife = 300;\n  var maxLife = 500;\n  var minSpeed = 10;\n  var maxSpeed = 200;\n  var particles = {};\n  for (var i = 0; i < maxCount; i++) {\n    var v = direction\n      .getUnitVector()\n      .scale(utils.randInt(minSpeed, maxSpeed))\n      .rotateRadians((Math.random() * Math.PI) / 3 - Math.PI / 6);\n    particleIndex++;\n    var particle = new SDK.Particle({\n      id: particleIndex,\n      particles: particles,\n      x: x,\n      y: y,\n      size: utils.randInt(minSize, maxSize),\n      color: color,\n      vx: v.x,\n      vy: v.y,\n      maxLife: utils.randInt(minLife, maxLife),\n      circle: true\n    });\n    particles[particleIndex] = particle;\n  }\n  return {\n    update: function() {\n      for (var id in particles) {\n        var particle = particles[id];\n        particle.update();\n        if (Date.now() - particle.createdAt >= particle.maxLife) {\n          delete particles[id];\n        }\n      }\n    },\n    draw: function(ctx, camera) {\n      ctx.save();\n      for (var id in particles) {\n        var particle = particles[id];\n        particle.draw(ctx, camera);\n      }\n      ctx.restore();\n    }\n  };\n};\n\nmodule.exports = {\n  sparksParticles: sparksParticles,\n  explosionParticles: explosionParticles,\n  hitParticles: hitParticles\n};\n","var Laser = require(\"./laser\");\n\nvar Ennemy = (function() {\n  function Ennemy(x, y) {\n    SDK.Circle.call(this, x, y, 10);\n\n    this.v = new SDK.Vector();\n    this.solid = false;\n    this.damage = 5; // damage the ennemy's attack inflicts\n    this.fireDelay = 500; // number of ms between two ennemy attacks\n    this.visionRange = 300;\n    this.attackRange = 500;\n    this.lasers = [];\n    this.lastFiredAt = Number.NEGATIVE_INFINITY;\n  }\n\n  Ennemy.prototype = Object.create(SDK.Circle.prototype);\n  Ennemy.prototype.constructor = Ennemy;\n\n  Ennemy.prototype.attack = function(direction) {\n    var center = this.center;\n    this.lastFiredAt = Date.now();\n    return new Laser({\n      x: center.x,\n      y: center.y,\n      direction: direction,\n      damage: this.damage,\n      range: this.attackRange,\n      color: \"lightgrey\"\n    });\n  };\n\n  Ennemy.prototype.update = function() {};\n\n  Ennemy.prototype.updateVelocity = function() {};\n\n  Ennemy.prototype.draw = function(ctx, camera) {\n    ctx.save();\n    ctx.fillStyle = \"red\";\n    ctx.beginPath();\n    ctx.arc(\n      camera.applyToX(this.x),\n      camera.applyToY(this.y),\n      camera.applyToDistance(this.r),\n      0,\n      Math.PI * 2\n    );\n    ctx.fill();\n    ctx.restore();\n  };\n\n  return Ennemy;\n})();\n\nmodule.exports = Ennemy;\n","var Platform = require(\"./platform\");\nvar utils = require('../utils');\n\nvar MovingPlatform = (function() {\n  function MovingPlatform(props) {\n    Platform.call(this, props);\n\n    this.xStart = props.x !== undefined ? props.x : 0;\n    this.yStart = props.x !== undefined ? props.y : 0;\n    this.xEnd = props.xEnd !== undefined ? props.xEnd : this.xStart;\n    this.yEnd = props.yEnd !== undefined ? props.yEnd : this.yStart;\n\n    this.speed = props.speed || 50;\n    this.v = new SDK.Vector(this.xEnd - this.x, this.yEnd - this.y);\n    var vNorm = this.v.norm;\n    this.v = this.v.scale(this.speed / vNorm);\n\n    this.color = \"rgb(0, 100, 255)\";\n    this.color = \"darkorange\";\n  }\n\n  MovingPlatform.prototype = Object.create(Platform.prototype);\n  MovingPlatform.prototype.constructor = MovingPlatform;\n\n  MovingPlatform.prototype.updateVelocity = function() {\n    // // horizontal velocity\n    // if (\n    //   this.v.x > 0 &&\n    //   ((this.xEnd - this.xStart) * (this.xEnd - this.x) < 0 ||\n    //     (this.xEnd - this.xStart) * (this.x - this.xStart) < 0)\n    // ) {\n    //   this.v.x = -Math.abs(this.v.x);\n    // } else if (\n    //   this.v.x < 0 &&\n    //   ((this.xEnd - this.xStart) * (this.xEnd - this.x) < 0 ||\n    //     (this.xEnd - this.xStart) * (this.x - this.xStart) < 0)\n    // ) {\n    //   this.v.x = Math.abs(this.v.x);\n    // }\n    // // vertical velocity\n    // if (\n    //   this.v.y > 0 &&\n    //   ((this.yEnd - this.yStart) * (this.yEnd - this.y) < 0 ||\n    //     (this.yEnd - this.yStart) * (this.y - this.yStart) < 0)\n    // ) {\n    //   this.v.y = -Math.abs(this.v.y);\n    // } else if (\n    //   this.v.y < 0 &&\n    //   ((this.yEnd - this.yStart) * (this.yEnd - this.y) < 0 ||\n    //     (this.yEnd - this.yStart) * (this.y - this.yStart) < 0)\n    // ) {\n    //   this.v.y = Math.abs(this.v.y);\n    // }\n  };\n\n  MovingPlatform.prototype.update = function() {\n    var dx = this.v.x * dt;\n    var dy = this.v.y * dt;\n    if (this.x + dx > this.xEnd || this.y + dy > this.yEnd) {\n      this.v.x = -Math.abs(this.v.x);\n      this.v.y = -Math.abs(this.v.y);\n    }\n    if (this.x + dx < this.xStart || this.y + dy < this.yStart) {\n      this.v.x = Math.abs(this.v.x);\n      this.v.y = Math.abs(this.v.y);\n    }\n\n    this.x = utils.toFixedPrecision(this.x + dx, 2);\n    this.y = utils.toFixedPrecision(this.y + dy, 2);\n  };\n\n  return MovingPlatform;\n})();\n\nmodule.exports = MovingPlatform;\n","var Skill = require(\"./skill\");\n\nfunction SkillHtml(props) {\n  Skill.call(\n    this,\n    Object.assign({}, props, {\n      src: \"./assets/images/html-5-icon.png\",\n      width: props.width || 50,\n      height: props.height || 50\n    })\n  );\n}\nSkillHtml.prototype = Object.create(Skill.prototype);\nSkillHtml.prototype.constructor = SkillHtml;\n\nfunction SkillCss(props) {\n  Skill.call(\n    this,\n    Object.assign({}, props, {\n      src: \"./assets/images/css-3-icon.png\",\n      width: props.width || 50,\n      height: props.height || 50\n    })\n  );\n}\nSkillCss.prototype = Object.create(Skill.prototype);\nSkillCss.prototype.constructor = SkillCss;\n\nfunction SkillSass(props) {\n  Skill.call(\n    this,\n    Object.assign({}, props, {\n      src: \"./assets/images/sass-logo.png\",\n      width: props.width || 50,\n      height: props.height || 50\n    })\n  );\n}\nSkillSass.prototype = Object.create(Skill.prototype);\nSkillSass.prototype.constructor = SkillSass;\n\nfunction SkillBootstrap(props) {\n  Skill.call(\n    this,\n    Object.assign({}, props, {\n      src: \"./assets/images/bootstrap-logo.png\",\n      width: props.width || 50,\n      height: props.height || 50\n    })\n  );\n}\nSkillBootstrap.prototype = Object.create(Skill.prototype);\nSkillBootstrap.prototype.constructor = SkillBootstrap;\n\nfunction SkillJquery(props) {\n  Skill.call(\n    this,\n    Object.assign({}, props, {\n      src: \"./assets/images/jquery-logo.png\",\n      width: props.width || 50,\n      height: props.height || 50\n    })\n  );\n}\nSkillJquery.prototype = Object.create(Skill.prototype);\nSkillJquery.prototype.constructor = SkillJquery;\n\nfunction SkillReact(props) {\n  Skill.call(\n    this,\n    Object.assign({}, props, {\n      src: \"./assets/images/react-logo.png\",\n      width: props.width || 50,\n      height: props.height || 50\n    })\n  );\n}\nSkillReact.prototype = Object.create(Skill.prototype);\nSkillReact.prototype.constructor = SkillReact;\n\nfunction SkillAngular(props) {\n  Skill.call(\n    this,\n    Object.assign({}, props, {\n      src: \"./assets/images/angular-logo.svg\",\n      width: props.width || 50,\n      height: props.height || 50\n    })\n  );\n}\nSkillAngular.prototype = Object.create(Skill.prototype);\nSkillAngular.prototype.constructor = SkillAngular;\n\nfunction SkillNode(props) {\n  Skill.call(\n    this,\n    Object.assign({}, props, {\n      src: \"./assets/images/nodejs-logo.png\",\n      width: props.width || 50,\n      height: props.height || 50\n    })\n  );\n}\nSkillNode.prototype = Object.create(Skill.prototype);\nSkillNode.prototype.constructor = SkillNode;\n\nfunction SkillMeteor(props) {\n  Skill.call(\n    this,\n    Object.assign({}, props, {\n      src: \"./assets/images/meteor-logo.png\",\n      width: props.width || 50,\n      height: props.height || 50\n    })\n  );\n}\nSkillMeteor.prototype = Object.create(Skill.prototype);\nSkillMeteor.prototype.constructor = SkillMeteor;\n\nfunction SkillMongo(props) {\n  Skill.call(\n    this,\n    Object.assign({}, props, {\n      src: \"./assets/images/mongodb-logo.png\",\n      width: props.width || 50,\n      height: props.height || 50\n    })\n  );\n}\nSkillMongo.prototype = Object.create(Skill.prototype);\nSkillMongo.prototype.constructor = SkillMongo;\n\nmodule.exports = {\n  SkillAngular: SkillAngular,\n  SkillBootstrap: SkillBootstrap,\n  SkillCss: SkillCss,\n  SkillHtml: SkillHtml,\n  SkillJquery: SkillJquery,\n  SkillMeteor: SkillMeteor,\n  SkillMongo: SkillMongo,\n  SkillNode: SkillNode,\n  SkillReact: SkillReact,\n  SkillSass: SkillSass\n};\n","var Player = require(\"./player\");\nvar Player = require(\"./player\");\nvar Ennemy = require(\"./ennemy\");\nvar Platform = require(\"./platform\");\nvar MovingPlatform = require(\"./movingPlatform\");\nvar skills = require(\"./skills\");\nvar SkillHtml = skills.SkillHtml;\nvar SkillCss = skills.SkillCss;\nvar SkillSass = skills.SkillSass;\nvar SkillBootstrap = skills.SkillBootstrap;\nvar SkillReact = skills.SkillReact;\nvar SkillAngular = skills.SkillAngular;\nvar SkillJquery = skills.SkillJquery;\nvar SkillNode = skills.SkillNode;\nvar SkillMongo = skills.SkillMongo;\nvar SkillMeteor = skills.SkillMeteor;\n\nvar LevelManager = (function() {\n  var level = {};\n\n  var gameEntityConstructors = {\n    Player: Player,\n    Ennemy: Ennemy,\n    Platform: Platform,\n    MovingPlatform: MovingPlatform,\n    SkillHtml: SkillHtml,\n    SkillCss: SkillCss,\n    SkillSass: SkillSass,\n    SkillBootstrap: SkillBootstrap,\n    SkillReact: SkillReact,\n    SkillAngular: SkillAngular,\n    SkillJquery: SkillJquery,\n    SkillNode: SkillNode,\n    SkillMongo: SkillMongo,\n    SkillMeteor: SkillMeteor\n  };\n\n  function LevelManager(props) {\n    this.data = props.data;\n    this.app = props.app;\n  }\n\n  LevelManager.prototype.buildLevel = function(name) {\n    if (!gameData.levels[name]) {\n      return null;\n    }\n    var levelData = gameData.levels[name];\n    var name = levelData.name;\n    var worldRectData = levelData.worldRect;\n    var playerData = levelData.player;\n    var platformsData = levelData.platforms;\n    var ennemiesData = levelData.ennemies;\n    var skillsData = levelData.skills;\n\n    level.name = name;\n    level.countdownStart = levelData.countdownStart;\n    level.worldRect = new SDK.Rectangle({\n      x: worldRectData.props.x,\n      y: worldRectData.props.y,\n      width: worldRectData.props.width,\n      height: worldRectData.props.height\n    });\n    level.player = new gameEntityConstructors[playerData.type](\n      playerData.props\n    );\n    level.platforms = [];\n    platformsData.forEach(function(platform) {\n      level.platforms.push(\n        new gameEntityConstructors[platform.type](platform.props)\n      );\n    });\n    level.ennemies = [];\n    ennemiesData.forEach(function(ennemy) {\n      level.ennemies.push(\n        new gameEntityConstructors[ennemy.type](ennemy.props.x, ennemy.props.y)\n      );\n    });\n    level.skills = [];\n    skillsData.forEach(function(skill) {\n      level.skills.push(new gameEntityConstructors[skill.type](skill.props));\n    });\n\n    // temporary objects\n    level.lasers = [];\n    level.particles = [];\n\n    return level;\n  };\n\n  /**\n   * Put all level entities inside a single array.\n   * @param {Array} extra\n   */\n  LevelManager.prototype.buildEntities = function(extra) {\n    level.entities = []\n      .concat(level.platforms)\n      .concat(level.skills)\n      .concat(level.ennemies)\n      .concat(level.lasers)\n      .concat([level.player]);\n\n    if (extra) {\n      level.entities = level.entities.concat(extra);\n    }\n  };\n\n  LevelManager.prototype.deleteLevel = function(name) {\n    delete gameData.levels[name];\n  };\n\n  return LevelManager;\n})();\n\nmodule.exports = LevelManager;\n","var Shield = (function() {\n  var MIN_SIZE = 0;\n  var MAX_SIZE = 40;\n\n  function Shield(props) {\n    this.shielded = props.shielded || null; // object benefitting from the shield\n    this.r = MIN_SIZE;\n    this.isOpen = false;\n    this.isAnimating = false;\n\n    // timings\n    this.openingDuration = 0.3;\n    this.closingDuration = 0.6;\n\n    // hit points\n    this.hitPoints = 200;\n\n    // sounds\n    this.sounds = {\n      open: new SDK.Sound(\"./assets/sounds/Open.mp3\", 0.1),\n      close: new SDK.Sound(\"./assets/sounds/Close.mp3\", 0.2)\n    };\n  }\n\n  Shield.prototype.getBoundingRect = function() {\n    var shielded = this.shielded;\n    return new SDK.Rectangle({\n      x: shielded.left - this.r,\n      y: shielded.top - this.r,\n      width: shielded.width + this.r * 2,\n      height: shielded.height + this.r * 2\n    });\n  };\n\n  Shield.prototype.open = function() {\n    this.sounds.close.stop();\n    this.sounds.open.play();\n    this.isOpen = true;\n    this.isAnimating = true;\n  };\n\n  Shield.prototype.close = function() {\n    this.sounds.open.stop();\n    this.sounds.close.play();\n    this.isOpen = false;\n    this.isAnimating = true;\n  };\n\n  Shield.prototype.update = function() {\n    var dr;\n    if (this.isOpen) {\n      dr = ((MAX_SIZE - MIN_SIZE) / this.openingDuration) * dt;\n      // shield opening\n      if (this.r + dr < MAX_SIZE) {\n        this.r += dr;\n      } else {\n        this.r = MAX_SIZE;\n        this.isAnimating = false;\n      }\n    } else {\n      dr = ((MAX_SIZE - MIN_SIZE) / this.closingDuration) * dt;\n      // shield closing\n      if (this.r - dr > MIN_SIZE) {\n        this.r -= dr;\n      } else {\n        this.r = MIN_SIZE;\n        this.isAnimating = false;\n      }\n    }\n  };\n\n  Shield.prototype.hasCollisionWithLaser = function(laser) {\n    var boundingRect = this.getBoundingRect();\n    var collision = SDK.physics.collision;\n    var shielded = this.shielded;\n    var r = this.r;\n\n    // return if the two shapes bounding rectangles don't collide\n    if (\n      !collision.RectangleWithRectangle(boundingRect, laser.getBoundingRect())\n    ) {\n      return false;\n    }\n\n    // the shield can be decomposed in 6 shapes\n    c1 = new SDK.Circle({ x: shielded.left, y: shielded.top, r: r });\n    c2 = new SDK.Circle({ x: shielded.right, y: shielded.top, r: r });\n    c3 = new SDK.Circle({ x: shielded.right, y: shielded.bottom, r: r });\n    c4 = new SDK.Circle({ x: shielded.left, y: shielded.bottom, r: r });\n    r1 = new SDK.Rectangle({\n      x: shielded.left - r,\n      y: shielded.top,\n      width: shielded.width + 2 * r,\n      height: shielded.height\n    });\n    r2 = new SDK.Rectangle({\n      x: shielded.left,\n      y: shielded.top - r,\n      width: shielded.width,\n      height: shielded.height + 2 * r\n    });\n\n    return (\n      c1.containsPoint(laser.A.x, laser.A.y) ||\n      c1.containsPoint(laser.B.x, laser.B.y) ||\n      c2.containsPoint(laser.A.x, laser.A.y) ||\n      c2.containsPoint(laser.B.x, laser.B.y) ||\n      c3.containsPoint(laser.A.x, laser.A.y) ||\n      c3.containsPoint(laser.B.x, laser.B.y) ||\n      c4.containsPoint(laser.A.x, laser.A.y) ||\n      c4.containsPoint(laser.B.x, laser.B.y) ||\n      r1.contains(laser.A.x, laser.A.y) ||\n      r1.contains(laser.B.x, laser.B.y) ||\n      r2.contains(laser.A.x, laser.A.y) ||\n      r2.contains(laser.B.x, laser.B.y)\n    );\n  };\n\n  Shield.prototype.draw = function(ctx, camera) {\n    var left = this.shielded.x - this.r;\n    var top = this.shielded.y - this.r;\n    var right = left + 2 * this.r + this.shielded.width;\n    var bottom = top + 2 * this.r + this.shielded.height;\n    var lineWidth = 2;\n\n    ctx.save();\n    ctx.fillStyle = \"rgba(255, 255, 255, 0.4)\";\n    ctx.strokeStyle = this.shielded.color;\n    ctx.lineWidth = camera.applyToDistance(lineWidth);\n    ctx.beginPath();\n    ctx.moveTo(camera.applyToX(left), camera.applyToY(top + this.r));\n    ctx.arcTo(\n      camera.applyToX(left),\n      camera.applyToY(top),\n      camera.applyToX(left + this.r),\n      camera.applyToY(top),\n      camera.applyToDistance(this.r)\n    );\n    ctx.lineTo(camera.applyToX(right - this.r), camera.applyToY(top));\n    ctx.arcTo(\n      camera.applyToX(right),\n      camera.applyToY(top),\n      camera.applyToX(right),\n      camera.applyToY(top + this.r),\n      camera.applyToDistance(this.r)\n    );\n    ctx.lineTo(camera.applyToX(right), camera.applyToY(bottom - this.r));\n    ctx.arcTo(\n      camera.applyToX(right),\n      camera.applyToY(bottom),\n      camera.applyToX(right - this.r),\n      camera.applyToY(bottom),\n      camera.applyToDistance(this.r)\n    );\n    ctx.lineTo(camera.applyToX(left + this.r), camera.applyToY(bottom));\n    ctx.arcTo(\n      camera.applyToX(left),\n      camera.applyToY(bottom),\n      camera.applyToX(left),\n      camera.applyToY(bottom - this.r),\n      camera.applyToDistance(this.r)\n    );\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n    ctx.restore();\n  };\n\n  return Shield;\n})();\n\nmodule.exports = Shield;\n","var SmokeParticle = (function() {\n  function SmokeParticle(props) {\n    SDK.Particle.call(this, props);\n\n    this.image = new Image();\n    this.image.src = \"./assets/images/smoke2.png\";\n  }\n\n  SmokeParticle.prototype = Object.create(SDK.Particle.prototype);\n  SmokeParticle.prototype.constructor = SmokeParticle;\n\n  SmokeParticle.prototype.draw = function(ctx, camera) {\n    ctx.globalAlpha = Math.max(\n      0,\n      1 - (Date.now() - this.createdAt) / this.maxLife\n    );\n    ctx.save();\n    ctx.drawImage(\n      this.image,\n      camera.applyToX(this.x),\n      camera.applyToY(this.y),\n      camera.applyToDistance(this.size),\n      camera.applyToDistance(this.size)\n    );\n    ctx.restore();\n  };\n  return SmokeParticle;\n})();\n\nmodule.exports = SmokeParticle;\n","var Laser = (function() {\n  function Laser(props) {\n    this.length = 20;\n    var A = new SDK.Vector(props.x, props.y);\n    var B = SDK.Vector.sum(A, props.direction.scale(this.length));\n    SDK.Segment.call(this, A, B);\n\n    this.origin = new SDK.Vector(props.x, props.y);\n    this.speed = 250;\n    this.v = SDK.Vector.subtract(B, A)\n      .getUnitVector()\n      .scale(this.speed);\n\n    // stats\n    this.damage = props.damage;\n\n    // timings\n    this.createdAt = Date.now();\n    this.range = props.range;\n\n    this.color = props.color;\n  }\n\n  Laser.prototype = Object.create(SDK.Segment.prototype);\n  Laser.prototype.constructor = Laser;\n\n  Laser.prototype.hasReachedMaxRange = function() {\n    return (\n      SDK.Vector.subtract(this.B, this.origin).normSquared >=\n      Math.pow(this.range, 2)\n    );\n  };\n\n  Laser.prototype.update = function() {\n    var dPos = this.v.scale(dt);\n    this.A = SDK.Vector.sum(this.A, dPos);\n    this.B = SDK.Vector.sum(this.B, dPos);\n  };\n\n  Laser.prototype.draw = function(ctx, camera) {\n    var lineWidth = 3;\n    ctx.save();\n    ctx.strokeStyle = this.color;\n    ctx.lineWidth = camera.applyToDistance(lineWidth);\n    ctx.beginPath();\n    ctx.moveTo(camera.applyToX(this.A.x), camera.applyToY(this.A.y));\n    ctx.lineTo(camera.applyToX(this.B.x), camera.applyToY(this.B.y));\n    ctx.stroke();\n    ctx.restore();\n  };\n\n  return Laser;\n})();\n\nmodule.exports = Laser;\n","var Skill = (function() {\n  function Skill(props) {\n    SDK.Rectangle.call(this, props);\n\n    this.v = new SDK.Vector();\n    this.solid = false;\n    this.image = new Image();\n    this.image.src = props.src;\n  }\n\n  Skill.prototype = Object.create(SDK.Rectangle.prototype);\n  Skill.prototype.constructor = Skill;\n\n  Skill.prototype.update = function() {};\n\n  Skill.prototype.draw = function(ctx, camera) {\n    ctx.save();\n    ctx.drawImage(\n      this.image,\n      camera.applyToX(this.x),\n      camera.applyToY(this.y),\n      camera.applyToDistance(this.width),\n      camera.applyToDistance(this.height)\n    );\n    ctx.restore();\n  };\n\n  return Skill;\n})();\n\nmodule.exports = Skill;\n","var Game = require(\"./game/game\");\n\nwindow.addEventListener(\"DOMContentLoaded\", function() {\n  // go fullscreen\n  document.documentElement.requestFullscreen =\n    document.documentElement.requestFullscreen ||\n    document.documentElement.webkitRequestFullScreen ||\n    document.documentElement.mozRequestFullScreen ||\n    document.documentElement.msRequestFullscreen;\n\n  var canvases = document.getElementsByTagName(\"canvas\");\n  var startGameButton = document.getElementById(\"start-game\");\n\n  function resize() {\n    for (var i = 0; i < canvases.length; i++) {\n      var canvas = canvases[i];\n      var canvasWidth = parseFloat(getComputedStyle(canvas).width);\n      var canvasHeight = parseFloat(getComputedStyle(canvas).height);\n      // change resolution\n      canvas.setAttribute(\"width\", canvasWidth);\n      canvas.setAttribute(\"height\", canvasHeight);\n    }\n  }\n\n  window.addEventListener(\"resize\", resize);\n\n  startGameButton.addEventListener(\"click\", function(e) {\n    e.preventDefault ? e.preventDefault() : (e.returnValue = false);\n    resize();\n\n    // instantiate game\n    window.game = new Game({\n      displayRulers: true,\n      displayDebug: false\n    });\n\n    game.start();\n  });\n\n  // update debug info\n  if (window.hasOwnProperty(\"game\")) {\n    setInterval(function() {\n      game.updateDebugInfo();\n    }, 50);\n  }\n});\n","var GameMenu = require(\"./gameMenu\");\nvar CollisionManager = require(\"./collisionManager\");\nvar LevelManager = require(\"./levelManager\");\nvar LifeBar = require(\"./lifebar\");\nvar SkillBar = require(\"./skillBar\");\nvar Ghost = require(\"./ghost\");\nvar Clock = require(\"./clock\");\nvar ClockDisplay = require(\"./clockDisplay\");\nvar utils = require(\"../utils\");\nwindow.gameData = require(\"./gameData.json\");\n\nvar Game = (function() {\n  function Game(config) {\n    SDK.Game.call(this, config);\n\n    // events\n    window.addEventListener(\"blur\", function(e) {\n      if (window.hasOwnProperty(\"game\")) {\n        game.pause();\n      }\n    });\n\n    // show game\n    this.introContainer = document.getElementById(\"game-intro\");\n    this.gameContainer = document.getElementById(\"game-container\");\n    utils.hide(this.introContainer);\n    utils.show(this.gameContainer);\n\n    // go fullscreen\n    document.documentElement.requestFullscreen &&\n      document.documentElement.requestFullscreen();\n\n    // config\n    if (config) {\n      if (config.displayDebug) {\n        this.debugIntervalID = setInterval(function() {\n          game.updateDebugInfo();\n        }, 50);\n      }\n      this.displayRulers =\n        config.displayRulers !== undefined ? config.displayRulers : true;\n    }\n\n    // game menu\n    this.gameMenu = new GameMenu({ game: this });\n\n    // initial game state\n    this.state = Game.states.PAUSED;\n\n    // initialize level manager\n    this.levelManager = new LevelManager({ data: gameData, app: this });\n    this.currentLevelName = \"level 1\";\n\n    // grid\n    this.grid = new SDK.Grid({\n      options: {\n        isGame: true,\n        displayRulers: this.displayRulers\n      },\n      canvas: this.canvas,\n      camera: this.camera,\n      mouse: this.mouse\n    });\n\n    // ghost\n    this.ghost = new Ghost();\n\n    // clock / timer\n    this.clock = new Clock();\n    this.clockDisplay = new ClockDisplay({\n      game: this,\n      x: canvas.width - 170,\n      y: 35,\n      width: 80,\n      height: 30\n    });\n  }\n\n  Game.prototype = Object.create(SDK.Game.prototype);\n  Game.prototype.constructor = Game;\n\n  Game.states = {\n    PAUSED: \"paused\",\n    RUNNING: \"running\",\n    GAME_OVER: \"game over\",\n    VICTORY: \"victory\",\n    EXIT: 0\n  };\n\n  Game.prototype.loadGameDataFromLocalStorage = function() {\n    var savedData = localStorage.getItem(\"gameData\");\n    if (savedData) {\n      gameData = JSON.parse(savedData);\n    }\n  };\n\n  Game.prototype.preload = function() {\n    var args = Array.prototype.slice.call(arguments);\n    var remainingCount = 0;\n    var images;\n    var lastArgument = args[args.length - 1];\n\n    if (typeof lastArgument === \"function\") {\n      done = lastArgument;\n      remainingCount = args.length - 1;\n      images = args.slice(0, args.length - 1);\n    } else {\n      remainingCount = args.length;\n      images = args;\n    }\n\n    this.images = {};\n\n    for (var i = 0; i < images.length; i++) {\n      var name = args[i].name;\n      var source = args[i].source;\n\n      this.images[name] = new Image();\n      this.images[name].src = source;\n      this.images[name].onload = function() {\n        remainingCount--;\n\n        if (remainingCount === 0) {\n          done();\n        }\n      };\n    }\n  };\n\n  Game.prototype.handleKeyboard = function() {\n    var keyboard = this.keyboard;\n    var touchInput = this.touchInput;\n    var player = this.level.player;\n\n    // do not handle keyboard if player is dead\n    if (player.isDead) {\n      return;\n    }\n\n    // increase player's horizontal speed based on user input\n    if (keyboard.keys.ArrowRight.isPressed || touchInput.JOYPAD_RIGHT) {\n      player.moveRight();\n    }\n    if (keyboard.keys.ArrowLeft.isPressed || touchInput.JOYPAD_LEFT) {\n      player.moveLeft();\n    }\n\n    // jump\n    if (\n      (keyboard.keys.ArrowDown.isPressed || touchInput.JOYPAD_DOWN) &&\n      player.GRAVITY_ACCELERATION < 0\n    ) {\n      player.jump();\n    }\n\n    if (\n      (keyboard.keys.ArrowUp.isPressed || touchInput.JOYPAD_UP) &&\n      player.GRAVITY_ACCELERATION > 0\n    ) {\n      player.jump();\n    }\n\n    if (keyboard.keys.Space.isPressed || touchInput.BUTTON_A) {\n      player.jump();\n    }\n\n    // shield\n    if (keyboard.keys.Enter.isPressed || touchInput.BUTTON_B) {\n      if (!player.shield.isAnimating) {\n        player.shield.isOpen ? player.shield.close() : player.shield.open();\n      }\n    }\n\n    // camera controls\n    if (keyboard.keys.Equal.isPressed) {\n      this.camera.zoomIn();\n    }\n\n    if (keyboard.keys.Minus.isPressed) {\n      this.camera.zoomOut();\n    }\n  };\n\n  Game.prototype.update = function() {\n    if (this.state === Game.states.RUNNING) {\n      // Order matters!\n      // First detect collisions and resolve player's position and speed.\n      // Then, handle keyboard and increase player's speed.\n      this.runPhysics();\n      this.handleKeyboard();\n    }\n\n    if (this.state === Game.states.PAUSED) {\n      this.camera.updateDimensions();\n      return;\n    }\n\n    var player = this.level.player;\n\n    // ghost\n    this.ghost.update();\n\n    // ennemies fire new lasers\n    !player.isDead &&\n      this.level.ennemies.forEach(function(ennemy) {\n        var distanceVector = SDK.Vector.subtract(player.center, ennemy.center);\n        if (\n          distanceVector.normSquared < Math.pow(ennemy.visionRange, 2) &&\n          Date.now() - ennemy.lastFiredAt > ennemy.fireDelay\n        ) {\n          var direction = distanceVector.getUnitVector();\n          this.level.lasers.push(ennemy.attack(direction));\n        }\n      }, this);\n\n    // lasers\n    this.level.lasers.forEach(function(laser, index) {\n      if (laser.hasReachedMaxRange()) {\n        this.collisionManager.destroyLaser(index);\n      } else {\n        laser.update();\n      }\n    }, this);\n\n    // shield\n    player.shield.update();\n\n    // platforms\n    this.level.platforms.forEach(function(platform) {\n      platform.update();\n    });\n\n    // player\n    player.update();\n\n    // particles\n    this.level.particles.forEach(function(particle, index) {\n      if (Date.now() - particle.createdAt > particle.maxLife) {\n        this.level.particles.splice(index, 1);\n      } else {\n        particle.update();\n      }\n    }, this);\n\n    // kill player if they move outside of the world boundaries\n    if (!player.isDead) {\n      if (\n        !player.within(this.level.worldRect) ||\n        this.clock.timeRemaining <= 0\n      ) {\n        player.die();\n      }\n    }\n\n    this.camera.update();\n    if (\n      this.state !== Game.states.GAME_OVER &&\n      this.state !== Game.states.VICTORY\n    ) {\n      this.clock.update();\n      this.checkVictory();\n      this.checkDefeat();\n    }\n  };\n\n  Game.prototype.setBackground = function(path) {\n    this.canvas.style.backgroundImage = \"url(\" + path + \")\";\n    this.canvas.backgroundSize = canvas.width + \"px \" + canvas.height + \"px\";\n  };\n\n  Game.prototype.pauseLoop = function() {\n    this.frame && cancelAnimationFrame(this.frame);\n    this.frame = null;\n  };\n\n  Game.prototype.exit = function() {\n    this.pauseLoop();\n    this.gameMenu.close();\n    utils.hide(this.gameMenu.gameContainerEl);\n    utils.show(this.introContainer);\n    this.state = Game.states.EXIT;\n    this.keyboard.unbindEventHandlers();\n    this.touchInput.unbindEventHandlers();\n    delete game;\n  };\n\n  Game.prototype.pause = function() {\n    if (\n      this.state !== Game.states.GAME_OVER &&\n      this.state !== Game.states.VICTORY\n    ) {\n      !this.gameMenuEl && this.gameMenu.showPauseMenu();\n      this.clock.pause();\n      this.soundManager.pauseAll();\n      this.state = Game.states.PAUSED;\n    }\n  };\n\n  Game.prototype.unpause = function() {\n    this.state !== Game.states.GAME_OVER &&\n      this.state !== Game.states.VICTORY &&\n      this.gameMenu.close();\n    this.clock.play();\n    this.soundManager.playPaused();\n    this.state = Game.states.RUNNING;\n  };\n\n  Game.prototype.displaySplash = function() {\n    var splash = document.getElementById(\"splash\");\n    splash.classList.remove(\"hidden\");\n  };\n\n  Game.prototype.hideSplash = function() {\n    var splash = document.getElementById(\"splash\");\n    splash.classList.add(\"hidden\");\n  };\n\n  Game.prototype.start = function() {\n    this.displaySplash();\n    setTimeout(\n      function() {\n        this.preload(\n          { name: \"htmlLogo\", source: \"assets/images/html-5-icon.png\" },\n          { name: \"cssLogo\", source: \"assets/images/css-3-icon.png\" },\n          { name: \"bootstrapLogo\", source: \"assets/images/bootstrap-logo.png\" },\n          { name: \"jqueryLogo\", source: \"assets/images/jquery-logo.png\" },\n          { name: \"sassLogo\", source: \"assets/images/sass-logo.png\" },\n          { name: \"nodeLogo\", source: \"assets/images/nodejs-logo.png\" },\n          { name: \"angularLogo\", source: \"assets/images/angular-logo.svg\" },\n          { name: \"reactLogo\", source: \"assets/images/react-logo.png\" },\n          { name: \"mongoLogo\", source: \"assets/images/mongodb-logo.png\" },\n          { name: \"meteorLogo\", source: \"assets/images/meteor-logo.png\" },\n          {\n            name: \"background\",\n            source: \"assets/images/background_2000_stars.png\"\n          },\n          {\n            name: \"smoke\",\n            source: \"assets/images/smoke2.png\"\n          },\n          function() {\n            this.hideSplash();\n            this.pause();\n            this.loadGameDataFromLocalStorage();\n            this.init();\n            this.step();\n          }.bind(this)\n        );\n      }.bind(this),\n      1500\n    );\n  };\n\n  Game.prototype.restart = function() {\n    this.gameMenu.close();\n    this.unpause();\n\n    this.init();\n    this.step();\n  };\n\n  Game.prototype.init = function() {\n    this.level = this.levelManager.buildLevel(this.currentLevelName);\n    this.clock.reset(this.level.countdownStart);\n    this.timer.reset();\n    this.levelManager.buildEntities();\n    this.collisionManager = new CollisionManager({\n      level: this.level,\n      clock: this.clock,\n      camera: this.camera\n    });\n    this.ghost.init({\n      clock: this.clock,\n      player: this.level.player\n    });\n    this.setBackground(\"./assets/images/background_2000_stars.png\");\n    this.camera.follow(\n      this.level.player,\n      (this.canvas.width - this.level.player.width) / 2 - 10,\n      (this.canvas.height - this.level.player.height) / 2 - 10\n    );\n    this.lifeBar = new LifeBar({\n      x: 60,\n      y: 40,\n      width: 200,\n      height: 15,\n      gameObject: this.level.player\n    });\n    this.skillBar = new SkillBar({\n      player: this.level.player,\n      skills: this.level.skills\n    });\n\n    // create keyboard event bindings\n    this.keyboard.keys.Pause.onDown = function() {\n      if (!this.keyboard.keys.Pause.repeat) {\n        this.state === \"running\" ? this.pause() : this.unpause();\n      }\n    };\n\n    this.keyboard.keys.KeyG.onDown = function() {\n      if (!this.keyboard.keys.KeyG.repeat) {\n        this.level.player.reverseGravity();\n      }\n    };\n\n    this.pauseLoop();\n  };\n\n  Game.prototype.runPhysics = function() {\n    this.level.player.applyGravity();\n    this.collisionManager.handleCollisions();\n  };\n\n  Game.prototype.checkVictory = function() {\n    if (\n      this.level.skills.length <= 0 &&\n      !(this.state === Game.states.GAME_OVER)\n    ) {\n      this.clock.pause();\n      this.state = Game.states.VICTORY;\n      this.level.player.v = new SDK.Vector(); // stop player\n      setTimeout(\n        function() {\n          this.gameMenu.showVictoryMenu();\n        }.bind(this),\n        1000\n      );\n    }\n  };\n\n  Game.prototype.checkDefeat = function() {\n    if (this.level.player.isDead && !(this.state === Game.states.GAME_OVER)) {\n      this.clock.pause();\n      this.state = Game.states.GAME_OVER;\n      setTimeout(\n        function() {\n          this.gameMenu.showGameOverMenu();\n        }.bind(this),\n        1500\n      );\n    }\n  };\n\n  // rendering\n  Game.prototype.render = function(ctx, camera) {\n    this.clearCanvas(ctx);\n    this.renderBackground(ctx, camera);\n    this.renderScene(ctx, camera);\n    this.renderUI(ctx, camera);\n  };\n\n  Game.prototype.clearCanvas = function(ctx) {\n    ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n  };\n\n  Game.prototype.renderBackground = function(ctx, camera) {\n    this.canvas.style.backgroundPosition =\n      -camera.x * 0.502 + \"px \" + -camera.y * 0.502 + \"px\";\n  };\n\n  Game.prototype.renderScene = function(ctx, camera) {\n    this.levelManager.buildEntities([this.ghost].concat(this.level.particles));\n\n    // only draw objects in the viewport\n    this.level.entities.forEach(function(entity) {\n      entity.draw(ctx, camera);\n    });\n  };\n\n  Game.prototype.renderUI = function(ctx, camera) {\n    this.uiElements = [\n      // this.lifeBar,\n      this.clockDisplay,\n      this.grid,\n      this.skillBar\n    ];\n\n    // UI\n    this.uiElements.forEach(function(uiElement) {\n      uiElement.draw(ctx, camera);\n    });\n  };\n\n  // debug display\n  Game.prototype.updateDebugInfo = function() {\n    var debugContainerEl = document.getElementById(\"debug-container\");\n    utils.emptyElement(debugContainerEl);\n    if (this.level) {\n      var debugEl = utils.h(\n        \"div\",\n        { class: \"debug\" },\n        utils.h(\"h2\", null, \"debug info\"),\n        utils.h(\n          \"section\",\n          { class: \"player\" },\n          utils.h(\n            \"p\",\n            null,\n            utils.h(\"strong\", null, \"x: \"),\n            this.level.player.x,\n            utils.h(\"br\"),\n            utils.h(\"strong\", null, \" y: \"),\n            this.level.player.y\n          ),\n          utils.h(\n            \"p\",\n            null,\n            utils.h(\"strong\", null, \"width: \"),\n            this.level.player.width,\n            utils.h(\"br\"),\n            utils.h(\"strong\", null, \" height: \"),\n            this.level.player.height\n          ),\n          utils.h(\n            \"p\",\n            null,\n            utils.h(\"strong\", null, \"crouching: \"),\n            this.level.player.isCrouching\n          ),\n          utils.h(\n            \"p\",\n            null,\n            utils.h(\"strong\", null, \"speedX: \"),\n            this.level.player.v.x,\n            utils.h(\"br\"),\n            utils.h(\"strong\", null, \" speedY: \"),\n            this.level.player.v.y\n          ),\n          utils.h(\n            \"p\",\n            null,\n            utils.h(\"strong\", null, \"accelX: \"),\n            this.level.player.acceleration.x,\n            utils.h(\"strong\", null, \" accelY: \"),\n            this.level.player.acceleration.y\n          ),\n          utils.h(\n            \"p\",\n            null,\n            utils.h(\"strong\", null, \"colliding: \"),\n            this.level.player.isColliding\n          )\n        ),\n        utils.h(\n          \"section\",\n          { class: \"camera\" },\n          utils.h(\"p\", null, [\n            utils.h(\"strong\", null, \"camX: \"),\n            this.camera.x\n          ]),\n          utils.h(\"p\", null, [utils.h(\"strong\", null, \"camY: \"), this.camera.y])\n        )\n      );\n      debugContainerEl.appendChild(utils.render(debugEl));\n    }\n  };\n\n  return Game;\n})();\n\nmodule.exports = Game;\n","var utils = require(\"../utils\");\n\nfunction GameMenu(props) {\n  this.game = props.game;\n\n  this.gameContainerEl = document.getElementById(\"game-container\");\n  this.uiContainerEl = document.getElementById(\"ui-container\");\n  this.gameIntroEl = document.getElementById(\"game-intro\");\n\n  // MENU BUTTONS\n  this.resumeButtonVNode = utils.h(\n    \"li\",\n    {\n      class: \"game-menu__item\"\n    },\n    utils.h(\n      \"a\",\n      {\n        href: \"\",\n        class: \"game-menu__link\",\n        onclick: function(event) {\n          event.preventDefault\n            ? event.preventDefault()\n            : (event.returnValue = false);\n          document.documentElement.requestFullscreen &&\n            document.documentElement.requestFullscreen();\n          this.game.unpause();\n        }.bind(this),\n        onkeyup: function(event) {\n          event.preventDefault\n            ? event.preventDefault()\n            : (event.returnValue = false);\n          if (event.keyCode === 13) {\n            event.target.click();\n          }\n        }\n      },\n      \"REPRENDRE\"\n    )\n  );\n\n  this.restartButtonVNode = utils.h(\n    \"li\",\n    {\n      class: \"game-menu__item\"\n    },\n    utils.h(\n      \"a\",\n      {\n        href: \"\",\n        class: \"game-menu__link\",\n        onclick: function(event) {\n          event.preventDefault\n            ? event.preventDefault()\n            : (event.returnValue = false);\n          document.documentElement.requestFullscreen &&\n            document.documentElement.requestFullscreen();\n          this.game.restart();\n        }.bind(this),\n        onkeyup: function(event) {\n          event.preventDefault\n            ? event.preventDefault()\n            : (event.returnValue = false);\n          if (event.keyCode === 13) {\n            event.target.click();\n          }\n        }\n      },\n      \"RECOMMENCER\"\n    )\n  );\n\n  this.controlsButtonVNode = utils.h(\n    \"li\",\n    {\n      class: \"game-menu__item\"\n    },\n    utils.h(\n      \"a\",\n      {\n        href: \"\",\n        class: \"game-menu__link\",\n        onclick: function(event) {\n          event.preventDefault\n            ? event.preventDefault()\n            : (event.returnValue = false);\n          this.showControlsMenu();\n        }.bind(this),\n        onkeyup: function(event) {\n          event.preventDefault\n            ? event.preventDefault()\n            : (event.returnValue = false);\n          if (event.keyCode === 13) {\n            event.target.click();\n          }\n        }\n      },\n      \"CONTRÔLES\"\n    )\n  );\n\n  this.aboutButtonVNode = utils.h(\n    \"li\",\n    {\n      class: \"game-menu__item\"\n    },\n    utils.h(\n      \"a\",\n      {\n        href: \"\",\n        class: \"game-menu__link\",\n        onclick: function(event) {\n          event.preventDefault\n            ? event.preventDefault()\n            : (event.returnValue = false);\n          this.showAboutMenu();\n        }.bind(this),\n        onkeyup: function(event) {\n          event.preventDefault\n            ? event.preventDefault()\n            : (event.returnValue = false);\n          if (event.keyCode === 13) {\n            event.target.click();\n          }\n        }\n      },\n      \"À PROPOS\"\n    )\n  );\n\n  this.backButtonVNode = utils.h(\n    \"li\",\n    {\n      class: \"game-menu__item\"\n    },\n    utils.h(\n      \"a\",\n      {\n        href: \"\",\n        class: \"game-menu__link\",\n        onclick: function(event) {\n          event.preventDefault\n            ? event.preventDefault()\n            : (event.returnValue = false);\n          this.game.state === this.game.constructor.states.PAUSED &&\n            this.showPauseMenu();\n          this.game.state === this.game.constructor.states.VICTORY &&\n            this.showVictoryMenu();\n          this.game.state === this.game.constructor.states.GAME_OVER &&\n            this.showGameOverMenu();\n        }.bind(this),\n        onkeyup: function(event) {\n          event.preventDefault\n            ? event.preventDefault()\n            : (event.returnValue = false);\n          if (event.keyCode === 13) {\n            event.target.click();\n          }\n        }\n      },\n      \"RETOUR\"\n    )\n  );\n\n  this.loadButtonVNode = utils.h(\n    \"li\",\n    {\n      class: \"game-menu__item\"\n    },\n    utils.h(\n      \"a\",\n      {\n        href: \"\",\n        class: \"game-menu__link\",\n        onclick: function(event) {\n          event.preventDefault\n            ? event.preventDefault()\n            : (event.returnValue = false);\n          this.showLoadMenu();\n        }.bind(this),\n        onkeyup: function(event) {\n          event.preventDefault\n            ? event.preventDefault()\n            : (event.returnValue = false);\n          if (event.keyCode === 13) {\n            event.target.click();\n          }\n        }\n      },\n      \"CHARGER UN NIVEAU\"\n    )\n  );\n\n  this.editorButtonVNode = utils.h(\n    \"li\",\n    { class: \"game-menu__item\" },\n    utils.h(\n      \"a\",\n      { href: \"./level-editor.html\", class: \"game-menu__link\" },\n      \"OUVRIR L'ÉDITEUR\"\n    )\n  );\n\n  this.exitButtonVNode = utils.h(\n    \"li\",\n    {\n      class: \"game-menu__item\"\n    },\n    utils.h(\n      \"a\",\n      {\n        href: \"\",\n        class: \"game-menu__link\",\n        onclick: function(event) {\n          event.preventDefault\n            ? event.preventDefault()\n            : (event.returnValue = false);\n          document.exitFullscreen =\n            document.exitFullscreen ||\n            document.webkitExitFullscreen ||\n            document.mozCancelFullScreen ||\n            document.msExitFullscreen;\n\n          document.exitFullscreen && document.exitFullscreen();\n\n          this.game.exit();\n        }.bind(this),\n        onkeyup: function(event) {\n          event.preventDefault\n            ? event.preventDefault()\n            : (event.returnValue = false);\n          if (event.keyCode === 13) {\n            event.target.click();\n          }\n        }\n      },\n      \"QUITTER LE JEU\"\n    )\n  );\n}\n\nGameMenu.prototype.showMenu = function(vNode) {\n  this.close();\n  this.uiContainerEl.appendChild(utils.render(vNode));\n};\n\nGameMenu.prototype.showGameOverMenu = function() {\n  this.showMenu(\n    utils.h(\n      \"div\",\n      { class: \"game-menu\" },\n      utils.h(\"h2\", null, \"PERDU !\"),\n      utils.h(\n        \"ul\",\n        { class: \"game-menu__list\" },\n        this.restartButtonVNode,\n        this.loadButtonVNode,\n        this.editorButtonVNode,\n        this.exitButtonVNode\n      )\n    )\n  );\n};\n\nGameMenu.prototype.showVictoryMenu = function() {\n  this.showMenu(\n    utils.h(\n      \"div\",\n      { class: \"game-menu\" },\n      utils.h(\"h2\", null, \"VICTOIRE !\"),\n      utils.h(\n        \"p\",\n        null,\n        \"Vous avez retrouvé toutes mes principales compétences, vous pouvez avoir plus d'infos en consultant mon cv détaillé \",\n        utils.h(\n          \"a\",\n          { href: \"./assets/files/CV Thomas Vandenhede.pdf\" },\n          \"ici\"\n        ),\n        \". Ou bien essayez de battre votre score.\"\n      ),\n      utils.h(\n        \"ul\",\n        { class: \"game-menu__list\" },\n        this.restartButtonVNode,\n        this.loadButtonVNode,\n        this.editorButtonVNode,\n        this.exitButtonVNode\n      )\n    )\n  );\n};\n\nGameMenu.prototype.showPauseMenu = function() {\n  this.showMenu(\n    utils.h(\n      \"div\",\n      { class: \"game-menu\" },\n      utils.h(\"h2\", null, \"JEU EN PAUSE\"),\n      utils.h(\n        \"ul\",\n        { class: \"game-menu__list\" },\n        this.resumeButtonVNode,\n        this.restartButtonVNode,\n        this.controlsButtonVNode,\n        this.loadButtonVNode,\n        this.editorButtonVNode,\n        this.aboutButtonVNode,\n        this.exitButtonVNode\n      )\n    )\n  );\n};\n\nGameMenu.prototype.showControlsMenu = function() {\n  this.showMenu(\n    utils.h(\n      \"div\",\n      { class: \"game-menu\" },\n      utils.h(\"h2\", null, \"CONTRÔLES\"),\n      utils.h(\n        \"ul\",\n        { class: \"game-menu__list\" },\n        utils.h(\n          \"div\",\n          { class: \"controls-container\" },\n          utils.h(\n            \"table\",\n            { class: \"controls\" },\n            utils.h(\n              \"tr\",\n              null,\n              utils.h(\n                \"th\",\n                null,\n                utils.h(\"span\", { class: \"kbd\" }, \"\\u2190\"),\n                \" / \",\n                utils.h(\"span\", { class: \"kbd\" }, \"\\u2192\"),\n                \" ou \",\n                utils.h(\"span\", { class: \"kbd\" }, \"Q\"),\n                \" / \",\n                utils.h(\"span\", { class: \"kbd\" }, \"D\")\n              ),\n              utils.h(\"td\", null, \"Se déplacer horizontalement\")\n            ),\n            utils.h(\n              \"tr\",\n              null,\n              utils.h(\n                \"th\",\n                null,\n                utils.h(\"span\", { class: \"kbd\" }, \"\\u2191\"),\n                \" ou \",\n                utils.h(\"span\", { class: \"kbd\" }, \"Espace\"),\n                \" ou \",\n                utils.h(\"span\", { class: \"kbd\" }, \"Z\")\n              ),\n              utils.h(\"td\", null, \"Sauter\")\n            ),\n            utils.h(\n              \"tr\",\n              null,\n              utils.h(\"th\", null, utils.h(\"span\", { class: \"kbd\" }, \"\\u21b2\")),\n              utils.h(\"td\", null, \"Ouvrir le bouclier\")\n            ),\n            utils.h(\n              \"tr\",\n              null,\n              utils.h(\"th\", null, utils.h(\"span\", { class: \"kbd\" }, \"Échap\")),\n              utils.h(\"td\", null, \"Afficher cet écran\")\n            ),\n            utils.h(\n              \"tr\",\n              null,\n              utils.h(\"th\", null, utils.h(\"span\", { class: \"kbd\" }, \"F11\")),\n              utils.h(\"td\", null, \"Plein écran\")\n            ),\n            utils.h(\n              \"tr\",\n              null,\n              utils.h(\n                \"th\",\n                null,\n                utils.h(\"span\", { class: \"kbd\" }, \"+\"),\n                \" / \",\n                utils.h(\"span\", { class: \"kbd\" }, \")\")\n              ),\n              utils.h(\"td\", null, \"Zoomer / Dézoomer\")\n            )\n          )\n        ),\n        this.backButtonVNode\n      )\n    )\n  );\n};\n\nGameMenu.prototype.showAboutMenu = function() {\n  this.showMenu(\n    utils.h(\n      \"div\",\n      { class: \"game-menu\" },\n      utils.h(\"h2\", null, \"À PROPOS\"),\n      utils.h(\n        \"p\",\n        null,\n        utils.h(\n          \"p\",\n          null,\n          \"Ce jeu est un projet que j'ai réalisé pour ma formation de Dev JS à l'Ifocop de Paris. Il a nécessité un bon mois de travail et pas mal de nuits blanches.\"\n        ),\n        utils.h(\n          \"p\",\n          null,\n          \"Le code est entièrement écrit en JavaScript, HTML et CSS et n'utilise aucun framework (hormis une touche de Bootstrap pour l'éditeur de niveaux).\"\n        )\n      ),\n      utils.h(\"ul\", { class: \"game-menu__list\" }, this.backButtonVNode)\n    )\n  );\n};\n\nGameMenu.prototype.showLoadMenu = function() {\n  this.showMenu(\n    utils.h(\n      \"div\",\n      { class: \"game-menu\" },\n      utils.h(\"h2\", null, \"CHARGER UN NIVEAU\"),\n      utils.h(\n        \"ul\",\n        { class: \"game-menu__list\" },\n        Object.keys(gameData.levels).map(\n          function(key) {\n            return utils.h(\n              \"li\",\n              null,\n              utils.h(\n                \"a\",\n                {\n                  href: \"\",\n                  onclick: function(event) {\n                    event.preventDefault\n                      ? event.preventDefault()\n                      : (event.returnValue = false);\n                    this.game.currentLevelName = gameData.levels[key].name;\n                    this.game.state = this.game.constructor.states.PAUSED;\n                    this.game.start();\n                  }.bind(this)\n                },\n                gameData.levels[key].name\n              )\n            );\n          }.bind(this)\n        )\n      ),\n      utils.h(\"ul\", { class: \"game-menu__list\" }, this.backButtonVNode)\n    )\n  );\n};\n\nGameMenu.prototype.close = function() {\n  var gameMenuEl = document.querySelector(\".game-menu\");\n  if (gameMenuEl) {\n    utils.emptyElement(gameMenuEl);\n    this.uiContainerEl.removeChild(gameMenuEl);\n  }\n};\n\nmodule.exports = GameMenu;\n","var particleEmitters = require(\"./particleEmitters\");\nvar utils = require(\"../utils\");\n\nfunction CollisionManager(props) {\n  this.level = props.level;\n  this.clock = props.clock;\n  this.camera = props.camera;\n}\n\nCollisionManager.prototype.handleCollisions = function() {\n  this.handleCollisionsWithPlatforms();\n  this.handleCollisionsWithSkills();\n  this.handleCollisionsWithLasers();\n};\n\nCollisionManager.prototype.handleCollisionsWithLasers = function() {\n  var playerBox = this.level.player.getBoundingRect();\n  !this.level.player.shield.isOpen\n    ? this.level.lasers.forEach(function(laser, index) {\n        var laserBox = laser.getBoundingRect();\n        if (SDK.physics.collision.RectangleWithRectangle(playerBox, laserBox)) {\n          if (\n            playerBox.contains(laser.A.x, laser.A.y) ||\n            playerBox.contains(laser.B.x, laser.B.y) ||\n            SDK.physics.collision.segmentRectangle(\n              laser.A,\n              laser.B,\n              playerBox\n            ) < Number.POSITIVE_INFINITY\n          ) {\n            this.level.player.applyDamage(laser.damage);\n            this.level.player.hitPoints <= 0 && this.level.player.die();\n            this.level.particles.push(\n              particleEmitters.hitParticles(\n                laser.B.x,\n                laser.B.y,\n                SDK.Vector.subtract(laser.A, laser.B),\n                \"red\"\n              )\n            );\n            this.destroyLaser(index);\n          }\n        }\n      }, this)\n    : this.level.lasers.forEach(function(laser, index) {\n        if (this.level.player.shield.hasCollisionWithLaser(laser)) {\n          this.destroyLaser(index);\n        }\n      }, this);\n};\n\nCollisionManager.prototype.destroyLaser = function(index) {\n  this.level.lasers.splice(index, 1);\n};\n\n// player acquires skill, no collision to resolve, skills simply disappears\nCollisionManager.prototype.handleCollisionsWithSkills = function() {\n  var playerBox = this.level.player.getBoundingRect();\n  this.level.skills.forEach(function(skill, index) {\n    var skillBox = skill.getBoundingRect();\n    if (SDK.physics.collision.RectangleWithRectangle(playerBox, skillBox)) {\n      this.level.player.skills.push(skill);\n      this.clock.countdownDuration += 5 * 1000; // add 5s to clock\n      this.level.skills.splice(index, 1);\n    }\n  }, this);\n};\n\nCollisionManager.prototype.getCollidablePlatformsInViewport = function() {\n  return this.level.platforms.filter(function(platform) {\n    var box = platform.getBoundingRect();\n    box.touched = false;\n    return box.overlaps(this.camera);\n  }, this);\n};\n\nCollisionManager.prototype.getCollisions = function(collidableGameObjects) {\n  var player = this.level.player;\n  var collisions = [];\n\n  // loop over each collidable object and store collision data\n  collidableGameObjects.forEach(function(box) {\n    var md = SDK.Rectangle.minkowskiDifference(box, player);\n    // window.md = md; // remove this when everything's working\n    var relMotion = SDK.Vector.subtract(player.v, box.v).scale(dt);\n    var colInfo = SDK.physics.collision.segmentRectangle(\n      new SDK.Vector(),\n      relMotion,\n      md\n    );\n    var t = colInfo.t;\n    var side = colInfo.side;\n\n    // create array of all collisions for that frame\n    if (t < Number.POSITIVE_INFINITY) {\n      var d = side[0] ? relMotion.x * side[0] : relMotion.y * side[1];\n      // If there is a collision along one of the axes,\n      // add collision to the array of collision characteristics\n      d > 0 &&\n        collisions.push({\n          side: side,\n          box: box,\n          d: d\n        });\n    }\n  });\n  return collisions;\n};\n\nCollisionManager.prototype.handleCollisionsWithPlatforms = function() {\n  var player = this.level.player;\n  var collidableWith = this.getCollidablePlatformsInViewport();\n  var collisions;\n  var boxH = null,\n    boxV = null;\n\n  // apply gravity acceleration and reset collisions\n  player.isColliding = [0, 0];\n\n  // determine all collisions between player and platforms\n  collisions = this.getCollisions(collidableWith);\n\n  /**\n   * COLLISION RESOLUTION\n   **/\n\n  // determine FINAL COLLISION characteristics\n  var dH = 0,\n    dV = 0;\n  collisions.forEach(function(collision) {\n    var side = collision.side;\n    var d = collision.d;\n    var box = collision.box;\n\n    // die if player has double sided collision\n    if (\n      side[0] * player.isColliding[0] < 0 ||\n      side[1] * player.isColliding[1] < 0\n    ) {\n      player.die();\n      return;\n    }\n\n    // set player collisions [0, 1] + [-1, 0] -> [-1, 1]\n    if (box.solid) {\n      player.isColliding[0] = side[0] || player.isColliding[0];\n      if (box.passthrough) {\n        player.isColliding[1] =\n          side[1] * player.GRAVITY_ACCELERATION > 0\n            ? side[1]\n            : player.isColliding[1];\n      } else {\n        player.isColliding[1] = side[1] || player.isColliding[1];\n      }\n    }\n\n    // if new value of d is greater than the old one then the new box is the one in contact with the player\n    if (side[0]) {\n      if (d > dH) {\n        dH = d;\n        boxH = box;\n      }\n    } else if (side[1]) {\n      if (d > dV) {\n        dV = d;\n        boxV = box;\n      }\n    }\n  });\n\n  // resolve horizontal collision\n  if (player.isColliding[0]) {\n    player.x =\n      player.isColliding[0] > 0\n        ? utils.toFixedPrecision(boxH.left + boxH.v.x * dt - player.width, 2) // snap\n        : utils.toFixedPrecision(boxH.right + boxH.v.x * dt, 2);\n  }\n  // resolve vertical collision\n  if (player.isColliding[1]) {\n    player.y =\n      player.isColliding[1] > 0\n        ? utils.toFixedPrecision(boxV.top + boxV.v.y * dt - player.height, 2)\n        : utils.toFixedPrecision(boxV.bottom + boxV.v.y * dt, 2);\n  }\n\n  // inform the player about which objects it's colliding with\n  player.collidingWith = [boxH, boxV];\n  if (boxH) {\n    boxH.touched = true;\n  }\n  if (boxV) {\n    boxV.touched = true;\n  }\n\n  // limit player's vertical speed when touching the ground\n  if (player.isColliding[1] * player.GRAVITY_ACCELERATION > 0) {\n    player.v.y = player.collidingWith[1].v.y;\n  }\n\n  // limit player's horizontal speed when touching a wall\n  if (player.isColliding[0]) {\n    player.v.x = player.collidingWith[0].v.x;\n  } else {\n    // player's base horizontal speed when touching the ground\n    player.v.x =\n      player.isColliding[1] * player.GRAVITY_ACCELERATION > 0\n        ? player.collidingWith[1].v.x\n        : 0;\n  }\n};\n\nmodule.exports = CollisionManager;\n","var LifeBar = (function() {\n  function LifeBar(props) {\n    SDK.Rectangle.call(this, props);\n    this.gameObject = props.gameObject;\n  }\n\n  LifeBar.prototype = Object.create(SDK.Rectangle.prototype);\n  LifeBar.prototype.constructor = LifeBar;\n\n  LifeBar.prototype.draw = function(ctx) {\n    var hitPointsRation = this.gameObject.getHitPointsRatio();\n    var lineWidth = 1;\n\n    ctx.save();\n    // life bar background\n    ctx.fillStyle = \"rgba(0, 0, 0, 0.3)\";\n    ctx.fillRect(this.x, this.y, this.width, this.height);\n\n    // life bar hit points\n    ctx.fillStyle = \"hsl(\" + hitPointsRation * 120 + \", 100%, 40%)\";\n    ctx.fillRect(this.x, this.y, this.width * hitPointsRation, this.height);\n\n    // life bar outline\n    ctx.strokeStyle = \"white\";\n    ctx.lineWidth = lineWidth;\n    ctx.beginPath();\n    ctx.strokeRect(\n      this.x - lineWidth / 2,\n      this.y - lineWidth / 2,\n      this.width + lineWidth,\n      this.height + lineWidth\n    );\n\n    ctx.fillStyle = \"white\";\n    ctx.font = \"bold 16px sans-serif\";\n    ctx.textAlign = \"center\";\n    ctx.fontWeight = \"bold\";\n    ctx.fillText(\n      Math.ceil(utils.toFixedPrecision(hitPointsRation * 100)) + \"%\",\n      this.x + this.width / 2,\n      this.y + this.height + 20\n    );\n    ctx.restore();\n  };\n\n  return LifeBar;\n})();\n\nmodule.exports = LifeBar;\n","function SkillBar(props) {\n  this.player = props.player;\n  this.skills = props.skills;\n}\n\nSkillBar.prototype.draw = function(ctx) {\n  var acquiredSkillsCount = this.player.skills.length;\n  var totalSkillsCount = acquiredSkillsCount + this.skills.length;\n  ctx.save();\n  ctx.fillStyle = \"rgba(0, 0, 0, 0.7)\";\n  ctx.fillRect(\n    60,\n    100,\n    100,\n    100 + ((acquiredSkillsCount + (acquiredSkillsCount % 2)) / 2) * 45\n  );\n  ctx.fillStyle = \"white\";\n  ctx.textAlign = \"center\";\n  ctx.font = \"16px arial\";\n  ctx.fillText(\"Skills\", 110, 130);\n  ctx.fillText(acquiredSkillsCount + \" / \" + totalSkillsCount, 110, 160);\n  this.player.skills.forEach(function(skill, index) {\n    ctx.drawImage(\n      skill.image,\n      70 + (index % 2) * 45,\n      200 + ((index - (index % 2)) / 2) * 45,\n      30,\n      30\n    );\n  }, this);\n  ctx.restore();\n};\n\nmodule.exports = SkillBar;\n","function Ghost() {}\n\nGhost.prototype.init = function(props) {\n  this.clock = props.clock;\n  this.player = props.player;\n  this.reset();\n};\n\nGhost.prototype.reset = function() {\n  this.ghostIndex = 0;\n  this.ghostPositions =\n    Array.isArray(this.ghostPositionsTemp) &&\n    this.ghostPositionsTemp.length !== 0\n      ? this.ghostPositionsTemp.slice(0)\n      : [];\n  this.ghostPositionsTemp = [];\n};\n\nGhost.prototype.update = function() {\n  // var totalTime = this.clock.timeEllapsed;\n  // var ghostTimes = this.ghostPositions.map(function(position) {\n  //   return position.time;\n  // });\n  // var currentGhostTime = ghostTimes.find(function(time, index) {\n  //   return totalTime >= time && totalTime < ghostTimes[index + 1];\n  // });\n  // var ghostIndex = ghostTimes.indexOf(currentGhostTime);\n  // var nextGhostTime = ghostTimes[ghostIndex + 1];\n\n  // var timeRatio =\n  //   (totalTime - currentGhostTime) / (nextGhostTime - currentGhostTime);\n\n  // if (this.ghostPositions.length) {\n  //   this.ghost = {};\n  //   this.ghost.x =\n  //     this.ghostPositions[ghostIndex].x +\n  //     (this.ghostPositions[ghostIndex + 1].x -\n  //       this.ghostPositions[ghostIndex].x) *\n  //       timeRatio;\n  //   this.ghost.y =\n  //     this.ghostPositions[ghostIndex].y +\n  //     (this.ghostPositions[ghostIndex + 1].y -\n  //       this.ghostPositions[ghostIndex].y) *\n  //       timeRatio;\n  // } else {\n  //   this.ghost = null;\n  // }\n  this.ghost = this.ghostPositions.length\n    ? this.ghostPositions[this.ghostIndex]\n    : null;\n  this.ghostPositions[this.ghostIndex + 1] && this.ghostIndex++;\n\n  // store position for next ghost\n  this.ghostPositionsTemp.push({\n    time: this.clock.timeEllapsed,\n    x: this.player.x,\n    y: this.player.y\n  });\n};\n\nGhost.prototype.draw = function(ctx, camera) {\n  if (this.ghost) {\n    ctx.save();\n    ctx.fillStyle = \"rgba(180, 180, 180, 0.7)\";\n    ctx.fillRect(\n      camera.applyToX(this.ghost.x),\n      camera.applyToY(this.ghost.y),\n      camera.applyToDistance(this.player.width),\n      camera.applyToDistance(this.player.height)\n    );\n    if (!this.ghostPositions[this.ghostIndex + 1]) {\n      ctx.strokeStyle = \"black\";\n      ctx.beginPath();\n      ctx.moveTo(camera.applyToX(this.ghost.x), camera.applyToY(this.ghost.y));\n      ctx.lineTo(\n        camera.applyToX(this.ghost.x + this.player.width),\n        camera.applyToY(this.ghost.y + this.player.height)\n      );\n      ctx.moveTo(\n        camera.applyToX(this.ghost.x + this.player.width),\n        camera.applyToY(this.ghost.y)\n      );\n      ctx.lineTo(\n        camera.applyToX(this.ghost.x),\n        camera.applyToY(this.ghost.y + this.player.height)\n      );\n      ctx.stroke();\n    }\n    ctx.restore();\n  }\n};\n\nmodule.exports = Ghost;\n","var SECONDS_IN_ONE_MINUTE = 60;\nvar MINUTES_IN_ONE_HOUR = 60;\nvar HOURS_IN_ONE_DAY = 24;\nvar ONE_SECOND_IN_MS = 1000;\nvar ONE_MINUTE_IN_MS = SECONDS_IN_ONE_MINUTE * ONE_SECOND_IN_MS;\nvar ONE_HOUR_IN_MS = MINUTES_IN_ONE_HOUR * ONE_MINUTE_IN_MS;\nvar ONE_DAY_IN_MS = HOURS_IN_ONE_DAY * ONE_HOUR_IN_MS;\n\nfunction Clock() {\n  this.isPaused = false;\n  this.hasMilliseconds = false;\n  this.isCountDown = true;\n}\n\nObject.defineProperties(Clock.prototype, {\n  timeRemaining: {\n    get: function() {\n      return this.countdownDuration - this.timeEllapsed;\n    }\n  }\n});\n\nClock.prototype.pause = function() {\n  this.isPaused = true;\n};\n\nClock.prototype.play = function() {\n  this.isPaused = false;\n  this.currentTime = Date.now();\n};\n\nClock.prototype.update = function() {\n  if (!this.isPaused) {\n    this.previousTime = this.currentTime;\n    this.currentTime = Date.now();\n    this.timeEllapsed += this.currentTime - this.previousTime;\n  }\n};\n\nClock.prototype.reset = function(initialDuration) {\n  var defaultDuration =\n    0 * ONE_DAY_IN_MS +\n    0 * ONE_HOUR_IN_MS +\n    180 * ONE_MINUTE_IN_MS +\n    2 * ONE_SECOND_IN_MS;\n\n  this.timeEllapsed = 0;\n  this.countdownDuration = initialDuration || defaultDuration; // ms;\n};\n\nClock.prototype.getValues = function() {\n  var displayTime = this.isCountDown\n    ? new Date(Math.max(0, this.timeRemaining))\n    : new Date(this.timeEllapsed);\n  var ms = displayTime.getTime();\n  var milliseconds, seconds, minutes, hours, days;\n  var round, values;\n\n  if (this.isCountDown && !this.hasMilliseconds) {\n    round = Math.ceil;\n  } else {\n    round = Math.floor;\n  }\n\n  milliseconds = ms % ONE_SECOND_IN_MS;\n  seconds = round(ms / ONE_SECOND_IN_MS) % SECONDS_IN_ONE_MINUTE;\n  minutes =\n    round((ms - seconds * ONE_SECOND_IN_MS) / ONE_MINUTE_IN_MS) %\n    MINUTES_IN_ONE_HOUR;\n  hours =\n    round(\n      (ms - minutes * ONE_MINUTE_IN_MS - seconds * ONE_SECOND_IN_MS) /\n        ONE_HOUR_IN_MS\n    ) % HOURS_IN_ONE_DAY;\n  days = round(\n    (ms -\n      hours * ONE_HOUR_IN_MS -\n      minutes * ONE_MINUTE_IN_MS -\n      seconds * ONE_SECOND_IN_MS) /\n      ONE_DAY_IN_MS\n  );\n\n  values = {\n    days: days,\n    hours: hours,\n    minutes: minutes,\n    seconds: seconds\n  };\n  if (this.hasMilliseconds) {\n    values.milliseconds = milliseconds;\n  }\n\n  return values;\n};\n\nmodule.exports = Clock;\n","function ClockDisplay(props) {\n  SDK.Rectangle.call(this, props);\n  this.DANGER_COUNTDOWN_TIME = 5000;\n  this.game = props.game;\n  this.timerEl = document.getElementById(\"gameclock\");\n}\n\nClockDisplay.prototype = Object.create(SDK.Rectangle.prototype);\nClockDisplay.prototype.constructor = ClockDisplay;\n\nClockDisplay.prototype.getText = function(values) {\n  var days = values.days;\n  var hours = values.hours;\n  var minutes = values.minutes;\n  var seconds = values.seconds;\n  var milliseconds = values.milliseconds;\n  var textArr = [];\n\n  if (values.days > 0) {\n    textArr.push(days.toString());\n  }\n  if (days > 0 || hours > 0) {\n    textArr.push(hours.toString().padStart(2, \"0\"));\n  }\n  textArr.push(\n    minutes.toString().padStart(2, \"0\"),\n    seconds.toString().padStart(2, \"0\")\n  );\n  if (this.game.clock.hasMilliseconds) {\n    textArr.push(\n      milliseconds\n        .toString()\n        .padStart(3, \"0\")\n        .substring(0, 2)\n    );\n  }\n\n  return textArr.join(\":\");\n};\n\n// update html element instead of drawing to the canvas\nClockDisplay.prototype.draw = function() {\n  var clock = this.game.clock;\n  var values = clock.getValues();\n  var text = this.getText(values);\n\n  if (this.timerEl.textContent !== text) {\n    if (clock.isCountDown && clock.timeRemaining < this.DANGER_COUNTDOWN_TIME) {\n      this.timerEl.classList.add(\"danger\");\n    } else {\n      this.timerEl.classList.contains(\"danger\") &&\n        this.timerEl.classList.remove(\"danger\");\n    }\n    this.timerEl.innerHTML = text;\n  }\n};\n\nmodule.exports = ClockDisplay;\n"],"sourceRoot":""}