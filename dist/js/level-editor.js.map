{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./js/utils.js","webpack:///./js/game/player.js","webpack:///./js/game/platform.js","webpack:///./js/game/particleEmitters.js","webpack:///./js/game/ennemy.js","webpack:///./js/game/movingPlatform.js","webpack:///./js/game/skills.js","webpack:///./js/game/levelManager.js","webpack:///./js/game/shield.js","webpack:///./js/game/smokeParticle.js","webpack:///./js/game/laser.js","webpack:///./js/game/skill.js","webpack:///./js/levelEditor.js","webpack:///./js/levelEditor/gameLevelEditor.js","webpack:///./js/levelEditor/creationTool.js","webpack:///./js/levelEditor/selectionTool.js","webpack:///./js/levelEditor/keyboardManager.js","webpack:///./js/levelEditor/toolbar.js","webpack:///./js/levelEditor/toolManager.js"],"names":["enumerable","get","getter","value","key","bind","module","Object","prototype","hasOwnProperty","call","object","property","id","exports","toFixedPrecision","number","precision","toFixed","noop","randInt","start","end","Math","floor","random","lerp","v0","v1","t","show","el","classList","remove","hide","add","incrementID","render","vdom","renderNode","vnode","document","createTextNode","element","createElement","type","props","keys","forEach","setAttribute","eventType","substring","addEventListener","children","childNode","undefined","appendChild","h","vNode","arguments","Array","slice","length","reduce","acc","item","isArray","concat","emptyElement","firstChild","removeChild","Shield","particleEmitters","utils","INITIAL_WIDTH","INITIAL_HEIGHT","Player","SDK","Rectangle","this","x","y","width","height","ABS_HORIZONTAL_MAX_SPEED","v","Vector","acceleration","solid","maxHitPoints","hitPoints","skills","color","getColorFromHP","isColliding","collidableWith","collidingWith","shield","shielded","sounds","jump","Sound","hit","still","die","hurt","stickyJump","GRAVITY_ACCELERATION","gameData","constants","create","constructor","moveLeft","moveRight","sign","sparks","sparksParticles","replay","reverseGravity","zeroGravity","applyDamage","damage","cb","isDead","stop","play","explosion","explosionParticles","applyGravity","dt","abs","update","dx","dy","getHitPointsRatio","draw","ctx","camera","center","save","strokeStyle","fillStyle","lineWidth","applyToDistance","fillRect","applyToX","applyToY","left","top","beginPath","moveTo","quadraticCurveTo","closePath","fill","restore","isOpen","isAnimating","Platform","passthrough","touched","rect","stroke","strokeRect","SmokeParticle","gameObj","Date","now","particleIndex","particles","minSpeed","maxSpeed","maxSize","minSize","maxLife","duration","addNewParticle","size","hasWon","particle","right","vx","vy","bottom","i","createdAt","j","Particle","hitParticles","direction","getUnitVector","scale","rotateRadians","PI","circle","Laser","Ennemy","Circle","fireDelay","visionRange","attackRange","lasers","lastFiredAt","Number","NEGATIVE_INFINITY","attack","range","updateVelocity","arc","r","MovingPlatform","xStart","yStart","xEnd","yEnd","speed","vNorm","norm","Skill","SkillHtml","assign","src","SkillCss","SkillSass","SkillBootstrap","SkillJquery","SkillReact","SkillAngular","SkillNode","SkillMeteor","SkillMongo","LevelManager","level","gameEntityConstructors","data","app","buildLevel","name","levels","levelData","worldRectData","worldRect","playerData","player","platformsData","platforms","ennemiesData","ennemies","skillsData","countdownStart","platform","push","ennemy","skill","buildEntities","extra","entities","deleteLevel","MIN_SIZE","openingDuration","closingDuration","open","close","getBoundingRect","dr","hasCollisionWithLaser","laser","boundingRect","collision","physics","RectangleWithRectangle","c1","c2","c3","c4","r1","r2","containsPoint","A","B","contains","arcTo","lineTo","image","Image","globalAlpha","max","drawImage","sum","Segment","origin","subtract","hasReachedMaxRange","normSquared","pow","dPos","LevelEditor","window","fitCanvasToContainer","canvases","getElementsByTagName","canvas","parseFloat","getComputedStyle","levelEditor","init","rulers","CreationTool","SelectionTool","KeyboardManager","Toolbar","ToolManager","options","config","displayRulers","getElementById","getContext","keyboard","mouse","MouseManager","soundManager","SoundManager","levelManager","gameObjects","Camera","zoomLevel","grid","Grid","isGame","selectionTool","creationTool","tools","0","1","toolManager","toolbar","loadGameDataFromLocalStorage","savedData","localStorage","getItem","JSON","parse","apply","updateToolbar","loadLevelSelect","map","option","levelNameInput","countdownInput","worldXInput","worldYInput","worldWidthInput","worldHeightInput","handleKeyboard","updateScene","renderBackground","fillCanvas","starCount","star","stars","opacity","updateTimeEllapsed","previousTime","currentTime","clearCanvas","clearRect","drawGrid","drawSelectionRectangle","selectionArea","drawSelectionOutlines","selectedObjects","selection","selectionRectangle","getSelectionBoundingRect","selectedObject","drawResizeHandles","resizeHandleHovered","renderScene","gameObject","overlaps","updateDimensions","main","requestAnimationFrame","generateJSONdata","parseInt","filter","constructorName","platformData","ennemyData","startsWith","skillData","alert","saveToLocalStorage","json","stringify","setItem","handleMouseDown","handleMouseUp","handleMouseMove","eventHandlers","mousedown","handler","mouseup","mousemove","e","mouseGamePosSnappedToGrid","getMouseGamePosSnappedToGrid","button","Constructor","gameObjectConstructor","currentObject","style","cursor","clickedObject","clickGamePosSnappedToGrid","clickX","clickY","mouseGameDisplacement","buttons","min","obj","newSelection","resizeHandleClicked","isMouseInsideResizeHandle","getClickedObject","objectStart","selectionObjects","includes","resizeHandlePos","resizeSelectedObjects","moveSelectedObjects","releaseX","releaseY","game","handleKeydown","keyRepeat","event","keyCode","gameObjectIndex","indexOf","splice","shift","tool","ctrlKey","preventDefault","objectTypeDropDown","focus","shiftKey","zoomOut","zoomIn","selectButton","createButton","saveButton","deleteButton","returnValue","currentLevelName","confirm","target","objectType","getGameObjectType","objectTypeMap","movingPlatform","skillHtml","skillCss","skillSass","skillBootstrap","skillJquery","skillReact","skillAngular","skillNode","skillMongo","skillMeteor","toolID","setEventHandlersForTool","defineProperties","set","unsetEventHandlersForTool","entries","off","on"],"mappings":"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","file":"level-editor.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 36);\n","module.exports = {\n  toFixedPrecision: function(number, precision) {\n    return +number.toFixed(precision || 0);\n  },\n\n  noop: function() {},\n\n  randInt: function(start, end) {\n    return Math.floor(Math.random() * (end - start + 1) + start);\n  },\n\n  lerp: function(v0, v1, t) {\n    return (1 - t) * v0 + t * v1;\n  },\n\n  show: function(el) {\n    el.classList.remove(\"hidden\");\n  },\n\n  hide: function(el) {\n    el.classList.add(\"hidden\");\n  },\n\n  incrementID: (function() {\n    var id = -1;\n    return function() {\n      id = id + 1;\n      return id;\n    };\n  })(),\n\n  // h: function(type, props, children) {\n  //   var el = document.createElement(type);\n  //   var nodes, node;\n  //   for (var key in props) {\n  //     el.setAttribute(key, props[key]);\n  //   }\n  //   if (Array.isArray(children)) {\n  //     nodes = children;\n  //   } else {\n  //     nodes = [children];\n  //   }\n  //   for (var i = 0; i < nodes.length; i++) {\n  //     if (typeof nodes[i] === \"string\") {\n  //       node = document.createTextNode(nodes[i]);\n  //     } else {\n  //       node = nodes[i];\n  //     }\n  //     el.appendChild(node);\n  //   }\n  //   return el;\n  // },\n\n  render: function(vdom) {\n    return (function renderNode(vnode) {\n      // vnode is a string\n      if (typeof vnode === \"string\" || typeof vnode === \"number\")\n        return document.createTextNode(vnode);\n\n      var element = document.createElement(vnode.type);\n      var props = vnode.props || {};\n\n      Object.keys(props).forEach(function(key) {\n        // treat events separately\n        if (typeof props[key] !== \"function\") {\n          element.setAttribute(key, props[key]);\n        }\n\n        // events\n        if (typeof props[key] === \"function\") {\n          var eventType = key.substring(2); // remove the 'on' part\n          element.addEventListener(eventType, props[key]);\n        }\n      });\n\n      (vnode.children || []).forEach(function(childNode) {\n        if (childNode === undefined) return;\n        return element.appendChild(renderNode(childNode));\n      });\n      return element;\n    })(vdom);\n  },\n\n  h: function() {\n    var vNode = {};\n    var type = arguments[0];\n    var props = arguments[1];\n    var children = Array.prototype.slice.call(arguments, 2);\n\n    vNode.type = type;\n    vNode.props = props;\n    if (children.length) {\n      vNode.children = children.reduce(function(acc, item) {\n        return Array.isArray(item) ? acc.concat(item) : acc.concat(item);\n      }, []);\n    } else {\n      vNode.children = null;\n    }\n\n    return vNode;\n  },\n\n  emptyElement: function(el) {\n    while (el.firstChild) {\n      el.removeChild(el.firstChild);\n    }\n  }\n};\n","var Shield = require(\"./shield\");\nvar particleEmitters = require(\"./particleEmitters\");\nvar utils = require(\"../utils\");\n\nvar ABS_JUMP_SPEED = 700;\nvar MAX_FALL_SPEED = 1000;\nvar INITIAL_WIDTH = 30;\nvar INITIAL_HEIGHT = 30;\n\nfunction Player(props) {\n  SDK.Rectangle.call(this, {\n    x: props.x,\n    y: props.y,\n    width: INITIAL_WIDTH,\n    height: INITIAL_HEIGHT\n  });\n\n  this.ABS_HORIZONTAL_MAX_SPEED = 250;\n  this.v = new SDK.Vector();\n  this.acceleration = new SDK.Vector();\n  this.solid = true; // can collide with other solid objects\n  this.maxHitPoints = 100;\n  this.hitPoints = this.maxHitPoints;\n  this.skills = []; // the player must harvest these\n  this.color = this.getColorFromHP();\n\n  // collision direction for movement\n  this.isColliding = [0, 0]; // [horizontal, vertical]\n  this.collidableWith = []; // potential object collisions\n  this.collidingWith = [null, null]; // actual object collisions\n  this.shield = new Shield({ shielded: this });\n\n  // sounds\n  this.sounds = {\n    jump: [\n      // new SDK.Sound(\"./assets/sounds/Swoosh1.mp3\", 0.25),\n      new SDK.Sound(\"./assets/sounds/Swoosh2.mp3\", 0.1),\n      new SDK.Sound(\"./assets/sounds/Swoosh3.mp3\", 0.3)\n    ],\n    hit: [\n      new SDK.Sound(\"./assets/sounds/Hit 1.mp4\", 0.2),\n      new SDK.Sound(\"./assets/sounds/Hit 2.mp4\", 0.2)\n    ],\n    still: new SDK.Sound(\"./assets/sounds/Medium hum.mp4\", 0.15),\n    die: new SDK.Sound(\"./assets/sounds/impactsplat03.mp3\", 0.8),\n    hurt: new SDK.Sound(\"./assets/sounds/Knife Stab.mp3\", 0.2)\n  };\n\n  // should the player get stuck to the ceiling when jumping?\n  this.stickyJump = false;\n\n  // player's own gravity\n  this.GRAVITY_ACCELERATION = gameData.constants.GRAVITY_ACCELERATION;\n}\n\nPlayer.prototype = Object.create(SDK.Rectangle.prototype);\nPlayer.prototype.constructor = Player;\n\nPlayer.prototype.moveLeft = function() {\n  this.v.x -= this.ABS_HORIZONTAL_MAX_SPEED;\n};\n\nPlayer.prototype.moveRight = function() {\n  this.v.x += this.ABS_HORIZONTAL_MAX_SPEED;\n};\n\nPlayer.prototype.jump = function() {\n  if (this.isColliding[1] === Math.sign(this.GRAVITY_ACCELERATION)) {\n    // emit particles\n    this.sparks = particleEmitters.sparksParticles(this);\n\n    this.sounds.jump[utils.randInt(0, this.sounds.jump.length - 1)].replay();\n    this.isColliding[1] = 0;\n    this.v.y = -Math.sign(this.GRAVITY_ACCELERATION) * ABS_JUMP_SPEED;\n  }\n};\n\nPlayer.prototype.reverseGravity = function() {\n  this.GRAVITY_ACCELERATION = -this.GRAVITY_ACCELERATION;\n};\n\nPlayer.prototype.zeroGravity = function() {\n  if (this.GRAVITY_ACCELERATION) {\n    this.GRAVITY_ACCELERATION = 0;\n  } else {\n    this.GRAVITY_ACCELERATION = gameData.constants.GRAVITY_ACCELERATION;\n  }\n};\n\nPlayer.prototype.applyDamage = function(damage) {\n  this.sounds.hurt.replay();\n  this.hitPoints = utils.toFixedPrecision(this.hitPoints - damage);\n};\n\nPlayer.prototype.die = function(cb) {\n  this.isDead = true;\n  this.hitPoints = 0;\n  this.color = this.getColorFromHP();\n  this.sounds.still.stop();\n  this.sounds.die.play();\n  this.explosion = particleEmitters.explosionParticles(this);\n  cb && cb();\n};\n\nPlayer.prototype.applyGravity = function() {\n  // apply gravity if player is free falling\n  this.acceleration.y = this.GRAVITY_ACCELERATION;\n\n  // compute new speed based on acceleration and time ellapsed\n  this.v.y += this.acceleration.y * dt;\n  this.v.y =\n    Math.abs(this.v.y) > MAX_FALL_SPEED\n      ? Math.sign(this.v.y) * MAX_FALL_SPEED\n      : this.v.y;\n};\n\nPlayer.prototype.update = function() {\n  if (this.isDead) {\n    this.explosion.update();\n    return;\n  } else {\n    this.sparks && this.sparks.update();\n  }\n\n  var dx = this.v.x * dt,\n    dy = this.v.y * dt;\n\n  // apply natural position increments if no collision detected\n  if (!this.isColliding[1]) {\n    this.y = utils.toFixedPrecision(this.y + dy, 4);\n  }\n  if (!this.isColliding[0]) {\n    this.x = utils.toFixedPrecision(this.x + dx, 4);\n  }\n};\n\nPlayer.prototype.getHitPointsRatio = function() {\n  return this.hitPoints / this.maxHitPoints;\n};\n\nPlayer.prototype.getColorFromHP = function() {\n  var hitPointsRatio = this.getHitPointsRatio();\n  var color = \"hsl(\" + hitPointsRatio * 120 + \", 100%, 50%)\";\n  return color;\n};\n\nPlayer.prototype.draw = function(ctx, camera) {\n  // draw particles\n  this.color = this.getColorFromHP();\n  this.isDead && this.explosion.draw(ctx, camera);\n  !this.isDead && this.sparks && this.sparks.draw(ctx, camera);\n\n  // draw player\n  if (!this.isDead) {\n    var center = this.center;\n    var lineWidth = 5;\n\n    ctx.save();\n    ctx.strokeStyle = this.color;\n    ctx.fillStyle = this.color;\n    ctx.lineWidth = camera.applyToDistance(lineWidth);\n    ctx.fillRect(\n      camera.applyToX(this.x),\n      camera.applyToY(this.y),\n      camera.applyToDistance(this.width),\n      camera.applyToDistance(this.height)\n    );\n\n    // draw mask\n    ctx.fillStyle = \"black\";\n    ctx.fillRect(\n      camera.applyToX(this.left),\n      camera.applyToY(this.top + 10),\n      camera.applyToDistance(this.width),\n      camera.applyToDistance(10)\n    );\n\n    // draw eyes\n    ctx.fillStyle = this.color;\n    ctx.beginPath();\n    ctx.moveTo(camera.applyToX(center.x - 10), camera.applyToY(this.top + 12));\n    ctx.quadraticCurveTo(\n      camera.applyToX(center.x - 4),\n      camera.applyToY(this.top + 14),\n      camera.applyToX(center.x - 4),\n      camera.applyToY(this.top + 16)\n    );\n    ctx.quadraticCurveTo(\n      camera.applyToX(center.x - 10),\n      camera.applyToY(this.top + 16),\n      camera.applyToX(center.x - 10),\n      camera.applyToY(this.top + 14)\n    );\n    ctx.closePath();\n    ctx.fill();\n    ctx.beginPath();\n    ctx.moveTo(camera.applyToX(center.x + 10), camera.applyToY(this.top + 12));\n    ctx.quadraticCurveTo(\n      camera.applyToX(center.x + 4),\n      camera.applyToY(this.top + 14),\n      camera.applyToX(center.x + 4),\n      camera.applyToY(this.top + 16)\n    );\n    ctx.quadraticCurveTo(\n      camera.applyToX(center.x + 10),\n      camera.applyToY(this.top + 16),\n      camera.applyToX(center.x + 10),\n      camera.applyToY(this.top + 14)\n    );\n    ctx.closePath();\n    ctx.fill();\n    ctx.restore();\n\n    // draw shield\n    if (this.shield.isOpen || this.shield.isAnimating) {\n      this.shield.draw(ctx, camera);\n    }\n  }\n};\n\nmodule.exports = Player;\n","var Platform = (function() {\n  var MAX_SPEED = 100;\n\n  function Platform(props) {\n    SDK.Rectangle.call(this, props);\n\n    this.v = new SDK.Vector();\n    this.solid = props && props.solid !== undefined ? props.solid : true; // can collide with other solid objects\n    this.passthrough =\n      props && props.passthrough !== undefined ? props.passthrough : false; // can it be traversed upwards\n    this.touched = false; // is the player touching the platform\n    this.color = \"#5e4c4c\";\n  }\n\n  Platform.prototype = Object.create(SDK.Rectangle.prototype);\n  Platform.prototype.constructor = Platform;\n\n  Platform.prototype.update = function() {};\n\n  Platform.prototype.draw = function(ctx, camera) {\n    var lineWidth = 3;\n    ctx.save();\n    ctx.lineWidth = camera.applyToDistance(lineWidth);\n    if (this.touched || !this.passthrough) {\n      ctx.strokeStyle = \"#db0000\";\n      ctx.fillStyle = this.color;\n      ctx.beginPath();\n      ctx.rect(\n        camera.applyToX(this.x + lineWidth / 2),\n        camera.applyToY(this.y + lineWidth / 2),\n        camera.applyToDistance(this.width - lineWidth),\n        camera.applyToDistance(this.height - lineWidth)\n      );\n      ctx.fill();\n      ctx.stroke();\n    } else {\n      lineWidth = 3;\n      ctx.strokeStyle = this.color;\n      ctx.lineWidth = camera.applyToDistance(lineWidth);\n      ctx.beginPath();\n      ctx.strokeRect(\n        camera.applyToX(this.x + lineWidth / 2),\n        camera.applyToY(this.y + lineWidth / 2),\n        camera.applyToDistance(this.width - lineWidth),\n        camera.applyToDistance(this.height - lineWidth)\n      );\n    }\n    ctx.restore();\n  };\n\n  return Platform;\n})();\n\nmodule.exports = Platform;\n","var SmokeParticle = require(\"./smokeParticle\");\nvar utils = require(\"../utils\");\n\nvar sparksParticles = function(gameObj) {\n  var start = Date.now();\n\n  return {\n    particleIndex: 0,\n    particles: {},\n    minSpeed: 5,\n    maxSpeed: 20,\n    maxSize: 20,\n    minSize: 3,\n    maxLife: 2000,\n    duration: 200,\n    addNewParticle: function() {\n      this.particleIndex++;\n      var t = (this.duration - (Date.now() - start)) / this.duration;\n      var size = utils.lerp(this.minSize, this.maxSize, t);\n      var color = !gameObj.hasWon\n        ? gameObj.color\n        : \"rgb(\" +\n          utils.randInt(0, 255) +\n          \", \" +\n          utils.randInt(0, 255) +\n          \", \" +\n          utils.randInt(0, 255) +\n          \")\";\n      switch (utils.randInt(0, 3)) {\n        case 0:\n          // top edge\n          particle = new SmokeParticle({\n            x: utils.randInt(gameObj.left, gameObj.right),\n            y: gameObj.top - size,\n            size: size,\n            color: color,\n            vx: utils.randInt(-this.maxSpeed, this.maxSpeed),\n            vy: utils.randInt(-this.maxSpeed, -this.minSpeed),\n            maxLife: this.maxLife\n          });\n          particle.id = this.particleIndex;\n          this.particles[this.particleIndex] = particle;\n          break;\n        case 1:\n          // bottom edge\n          particle = new SmokeParticle({\n            x: utils.randInt(gameObj.left, gameObj.right),\n            y: gameObj.bottom,\n            size: size,\n            color: color,\n            vx: utils.randInt(-this.maxSpeed, this.maxSpeed),\n            vy: utils.randInt(this.minSpeed, this.maxSpeed),\n            maxLife: this.maxLife\n          });\n          particle.id = this.particleIndex;\n          this.particles[this.particleIndex] = particle;\n          break;\n        case 2:\n          // left edge\n          particle = new SmokeParticle({\n            x: gameObj.left - size,\n            y: utils.randInt(gameObj.top, gameObj.bottom),\n            size: size,\n            color: color,\n            vx: utils.randInt(-this.maxSpeed, -this.minSpeed),\n            vy: utils.randInt(-this.maxSpeed, this.maxSpeed),\n            maxLife: this.maxLife\n          });\n          particle.id = this.particleIndex;\n          this.particles[this.particleIndex] = particle;\n          break;\n        case 3:\n          // right edge\n          particle = new SmokeParticle({\n            x: gameObj.right,\n            y: utils.randInt(gameObj.top, gameObj.bottom),\n            size: size,\n            color: color,\n            vx: utils.randInt(this.minSpeed, this.maxSpeed),\n            vy: utils.randInt(-this.maxSpeed, this.maxSpeed),\n            maxLife: this.maxLife\n          });\n          particle.id = this.particleIndex;\n          this.particles[this.particleIndex] = particle;\n          break;\n      }\n    },\n    update: function() {\n      // only add particles for a certain duration\n      if (Date.now() <= start + this.duration) {\n        for (var i = 0; i < 2; i++) {\n          this.addNewParticle();\n        }\n      }\n\n      for (var id in this.particles) {\n        var particle = this.particles[id];\n        particle.update();\n        if (Date.now() - particle.createdAt >= this.maxLife) {\n          delete this.particles[id];\n        }\n      }\n    },\n    draw: function(ctx, camera) {\n      ctx.save();\n      for (var id in this.particles) {\n        var particle = this.particles[id];\n        particle.draw(ctx, camera);\n      }\n      ctx.restore();\n    }\n  };\n};\n\nvar explosionParticles = function(gameObj) {\n  var size = 5;\n  var minLife = 500;\n  var maxLife = 1500;\n  var particles = [];\n  var minSpeed = 10;\n  var maxSpeed = 50;\n  var particleIndex = 0;\n  for (var i = gameObj.left; i < gameObj.right; i += size) {\n    for (var j = gameObj.top; j < gameObj.bottom; j += size) {\n      var center = gameObj.center;\n      var v = new SDK.Vector(\n        utils.randInt(-maxSpeed * 5, maxSpeed * 5),\n        utils.randInt(\n          -Math.sign(gameObj.GRAVITY_ACCELERATION) * maxSpeed * 10,\n          -Math.sign(gameObj.GRAVITY_ACCELERATION) * minSpeed * 10\n        )\n      );\n      var particle = new SDK.Particle({\n        x: i,\n        y: j,\n        size: size,\n        color: gameObj.color,\n        vx: v.x,\n        vy: v.y,\n        maxLife: utils.randInt(minLife, maxLife)\n      });\n      particles[particleIndex] = particle;\n      particleIndex++;\n      var v = new SDK.Vector(\n        utils.randInt(-maxSpeed * 5, maxSpeed * 5),\n        utils.randInt(\n          -Math.sign(gameObj.GRAVITY_ACCELERATION) * maxSpeed * 10,\n          -Math.sign(gameObj.GRAVITY_ACCELERATION) * minSpeed * 10\n        )\n      );\n      var particle = new SDK.Particle({\n        x: i,\n        y: j,\n        size: size,\n        color: gameObj.color,\n        vx: v.x,\n        vy: v.y,\n        maxLife: utils.randInt(minLife, maxLife)\n      });\n      particles[particleIndex] = particle;\n      particleIndex++;\n    }\n  }\n  return {\n    update: function() {\n      for (var id in particles) {\n        var particle = particles[id];\n        particle.v.y += (gameObj.GRAVITY_ACCELERATION / 4) * dt;\n        particle.update();\n        if (Date.now() - particle.createdAt >= particle.maxLife) {\n          delete particles[id];\n        }\n      }\n    },\n    draw: function(ctx, camera) {\n      ctx.save();\n      for (var id in particles) {\n        var particle = particles[id];\n        particle.draw(ctx, camera);\n      }\n      ctx.restore();\n    }\n  };\n};\n\nvar hitParticles = function(x, y, direction, color) {\n  var createdAt = Date.now();\n  var particleIndex = 0;\n  var maxCount = 30;\n  var minSize = 2;\n  var maxSize = 6;\n  var minLife = 300;\n  var maxLife = 500;\n  var minSpeed = 10;\n  var maxSpeed = 200;\n  var particles = {};\n  for (var i = 0; i < maxCount; i++) {\n    var v = direction\n      .getUnitVector()\n      .scale(utils.randInt(minSpeed, maxSpeed))\n      .rotateRadians((Math.random() * Math.PI) / 3 - Math.PI / 6);\n    particleIndex++;\n    var particle = new SDK.Particle({\n      id: particleIndex,\n      particles: particles,\n      x: x,\n      y: y,\n      size: utils.randInt(minSize, maxSize),\n      color: color,\n      vx: v.x,\n      vy: v.y,\n      maxLife: utils.randInt(minLife, maxLife),\n      circle: true\n    });\n    particles[particleIndex] = particle;\n  }\n  return {\n    update: function() {\n      for (var id in particles) {\n        var particle = particles[id];\n        particle.update();\n        if (Date.now() - particle.createdAt >= particle.maxLife) {\n          delete particles[id];\n        }\n      }\n    },\n    draw: function(ctx, camera) {\n      ctx.save();\n      for (var id in particles) {\n        var particle = particles[id];\n        particle.draw(ctx, camera);\n      }\n      ctx.restore();\n    }\n  };\n};\n\nmodule.exports = {\n  sparksParticles: sparksParticles,\n  explosionParticles: explosionParticles,\n  hitParticles: hitParticles\n};\n","var Laser = require(\"./laser\");\n\nvar Ennemy = (function() {\n  function Ennemy(x, y) {\n    SDK.Circle.call(this, x, y, 10);\n\n    this.v = new SDK.Vector();\n    this.solid = false;\n    this.damage = 5; // damage the ennemy's attack inflicts\n    this.fireDelay = 500; // number of ms between two ennemy attacks\n    this.visionRange = 300;\n    this.attackRange = 500;\n    this.lasers = [];\n    this.lastFiredAt = Number.NEGATIVE_INFINITY;\n  }\n\n  Ennemy.prototype = Object.create(SDK.Circle.prototype);\n  Ennemy.prototype.constructor = Ennemy;\n\n  Ennemy.prototype.attack = function(direction) {\n    var center = this.center;\n    this.lastFiredAt = Date.now();\n    return new Laser({\n      x: center.x,\n      y: center.y,\n      direction: direction,\n      damage: this.damage,\n      range: this.attackRange,\n      color: \"lightgrey\"\n    });\n  };\n\n  Ennemy.prototype.update = function() {};\n\n  Ennemy.prototype.updateVelocity = function() {};\n\n  Ennemy.prototype.draw = function(ctx, camera) {\n    ctx.save();\n    ctx.fillStyle = \"red\";\n    ctx.beginPath();\n    ctx.arc(\n      camera.applyToX(this.x),\n      camera.applyToY(this.y),\n      camera.applyToDistance(this.r),\n      0,\n      Math.PI * 2\n    );\n    ctx.fill();\n    ctx.restore();\n  };\n\n  return Ennemy;\n})();\n\nmodule.exports = Ennemy;\n","var Platform = require(\"./platform\");\nvar utils = require('../utils');\n\nvar MovingPlatform = (function() {\n  function MovingPlatform(props) {\n    Platform.call(this, props);\n\n    this.xStart = props.x !== undefined ? props.x : 0;\n    this.yStart = props.x !== undefined ? props.y : 0;\n    this.xEnd = props.xEnd !== undefined ? props.xEnd : this.xStart;\n    this.yEnd = props.yEnd !== undefined ? props.yEnd : this.yStart;\n\n    this.speed = props.speed || 50;\n    this.v = new SDK.Vector(this.xEnd - this.x, this.yEnd - this.y);\n    var vNorm = this.v.norm;\n    this.v = this.v.scale(this.speed / vNorm);\n\n    this.color = \"rgb(0, 100, 255)\";\n    this.color = \"darkorange\";\n  }\n\n  MovingPlatform.prototype = Object.create(Platform.prototype);\n  MovingPlatform.prototype.constructor = MovingPlatform;\n\n  MovingPlatform.prototype.updateVelocity = function() {\n    // // horizontal velocity\n    // if (\n    //   this.v.x > 0 &&\n    //   ((this.xEnd - this.xStart) * (this.xEnd - this.x) < 0 ||\n    //     (this.xEnd - this.xStart) * (this.x - this.xStart) < 0)\n    // ) {\n    //   this.v.x = -Math.abs(this.v.x);\n    // } else if (\n    //   this.v.x < 0 &&\n    //   ((this.xEnd - this.xStart) * (this.xEnd - this.x) < 0 ||\n    //     (this.xEnd - this.xStart) * (this.x - this.xStart) < 0)\n    // ) {\n    //   this.v.x = Math.abs(this.v.x);\n    // }\n    // // vertical velocity\n    // if (\n    //   this.v.y > 0 &&\n    //   ((this.yEnd - this.yStart) * (this.yEnd - this.y) < 0 ||\n    //     (this.yEnd - this.yStart) * (this.y - this.yStart) < 0)\n    // ) {\n    //   this.v.y = -Math.abs(this.v.y);\n    // } else if (\n    //   this.v.y < 0 &&\n    //   ((this.yEnd - this.yStart) * (this.yEnd - this.y) < 0 ||\n    //     (this.yEnd - this.yStart) * (this.y - this.yStart) < 0)\n    // ) {\n    //   this.v.y = Math.abs(this.v.y);\n    // }\n  };\n\n  MovingPlatform.prototype.update = function() {\n    var dx = this.v.x * dt;\n    var dy = this.v.y * dt;\n    if (this.x + dx > this.xEnd || this.y + dy > this.yEnd) {\n      this.v.x = -Math.abs(this.v.x);\n      this.v.y = -Math.abs(this.v.y);\n    }\n    if (this.x + dx < this.xStart || this.y + dy < this.yStart) {\n      this.v.x = Math.abs(this.v.x);\n      this.v.y = Math.abs(this.v.y);\n    }\n\n    this.x = utils.toFixedPrecision(this.x + dx, 2);\n    this.y = utils.toFixedPrecision(this.y + dy, 2);\n  };\n\n  return MovingPlatform;\n})();\n\nmodule.exports = MovingPlatform;\n","var Skill = require(\"./skill\");\n\nfunction SkillHtml(props) {\n  Skill.call(\n    this,\n    Object.assign({}, props, {\n      src: \"./assets/images/html-5-icon.png\",\n      width: props.width || 50,\n      height: props.height || 50\n    })\n  );\n}\nSkillHtml.prototype = Object.create(Skill.prototype);\nSkillHtml.prototype.constructor = SkillHtml;\n\nfunction SkillCss(props) {\n  Skill.call(\n    this,\n    Object.assign({}, props, {\n      src: \"./assets/images/css-3-icon.png\",\n      width: props.width || 50,\n      height: props.height || 50\n    })\n  );\n}\nSkillCss.prototype = Object.create(Skill.prototype);\nSkillCss.prototype.constructor = SkillCss;\n\nfunction SkillSass(props) {\n  Skill.call(\n    this,\n    Object.assign({}, props, {\n      src: \"./assets/images/sass-logo.png\",\n      width: props.width || 50,\n      height: props.height || 50\n    })\n  );\n}\nSkillSass.prototype = Object.create(Skill.prototype);\nSkillSass.prototype.constructor = SkillSass;\n\nfunction SkillBootstrap(props) {\n  Skill.call(\n    this,\n    Object.assign({}, props, {\n      src: \"./assets/images/bootstrap-logo.png\",\n      width: props.width || 50,\n      height: props.height || 50\n    })\n  );\n}\nSkillBootstrap.prototype = Object.create(Skill.prototype);\nSkillBootstrap.prototype.constructor = SkillBootstrap;\n\nfunction SkillJquery(props) {\n  Skill.call(\n    this,\n    Object.assign({}, props, {\n      src: \"./assets/images/jquery-logo.png\",\n      width: props.width || 50,\n      height: props.height || 50\n    })\n  );\n}\nSkillJquery.prototype = Object.create(Skill.prototype);\nSkillJquery.prototype.constructor = SkillJquery;\n\nfunction SkillReact(props) {\n  Skill.call(\n    this,\n    Object.assign({}, props, {\n      src: \"./assets/images/react-logo.png\",\n      width: props.width || 50,\n      height: props.height || 50\n    })\n  );\n}\nSkillReact.prototype = Object.create(Skill.prototype);\nSkillReact.prototype.constructor = SkillReact;\n\nfunction SkillAngular(props) {\n  Skill.call(\n    this,\n    Object.assign({}, props, {\n      src: \"./assets/images/angular-logo.svg\",\n      width: props.width || 50,\n      height: props.height || 50\n    })\n  );\n}\nSkillAngular.prototype = Object.create(Skill.prototype);\nSkillAngular.prototype.constructor = SkillAngular;\n\nfunction SkillNode(props) {\n  Skill.call(\n    this,\n    Object.assign({}, props, {\n      src: \"./assets/images/nodejs-logo.png\",\n      width: props.width || 50,\n      height: props.height || 50\n    })\n  );\n}\nSkillNode.prototype = Object.create(Skill.prototype);\nSkillNode.prototype.constructor = SkillNode;\n\nfunction SkillMeteor(props) {\n  Skill.call(\n    this,\n    Object.assign({}, props, {\n      src: \"./assets/images/meteor-logo.png\",\n      width: props.width || 50,\n      height: props.height || 50\n    })\n  );\n}\nSkillMeteor.prototype = Object.create(Skill.prototype);\nSkillMeteor.prototype.constructor = SkillMeteor;\n\nfunction SkillMongo(props) {\n  Skill.call(\n    this,\n    Object.assign({}, props, {\n      src: \"./assets/images/mongodb-logo.png\",\n      width: props.width || 50,\n      height: props.height || 50\n    })\n  );\n}\nSkillMongo.prototype = Object.create(Skill.prototype);\nSkillMongo.prototype.constructor = SkillMongo;\n\nmodule.exports = {\n  SkillAngular: SkillAngular,\n  SkillBootstrap: SkillBootstrap,\n  SkillCss: SkillCss,\n  SkillHtml: SkillHtml,\n  SkillJquery: SkillJquery,\n  SkillMeteor: SkillMeteor,\n  SkillMongo: SkillMongo,\n  SkillNode: SkillNode,\n  SkillReact: SkillReact,\n  SkillSass: SkillSass\n};\n","var Player = require(\"./player\");\nvar Player = require(\"./player\");\nvar Ennemy = require(\"./ennemy\");\nvar Platform = require(\"./platform\");\nvar MovingPlatform = require(\"./movingPlatform\");\nvar skills = require(\"./skills\");\nvar SkillHtml = skills.SkillHtml;\nvar SkillCss = skills.SkillCss;\nvar SkillSass = skills.SkillSass;\nvar SkillBootstrap = skills.SkillBootstrap;\nvar SkillReact = skills.SkillReact;\nvar SkillAngular = skills.SkillAngular;\nvar SkillJquery = skills.SkillJquery;\nvar SkillNode = skills.SkillNode;\nvar SkillMongo = skills.SkillMongo;\nvar SkillMeteor = skills.SkillMeteor;\n\nvar LevelManager = (function() {\n  var level = {};\n\n  var gameEntityConstructors = {\n    Player: Player,\n    Ennemy: Ennemy,\n    Platform: Platform,\n    MovingPlatform: MovingPlatform,\n    SkillHtml: SkillHtml,\n    SkillCss: SkillCss,\n    SkillSass: SkillSass,\n    SkillBootstrap: SkillBootstrap,\n    SkillReact: SkillReact,\n    SkillAngular: SkillAngular,\n    SkillJquery: SkillJquery,\n    SkillNode: SkillNode,\n    SkillMongo: SkillMongo,\n    SkillMeteor: SkillMeteor\n  };\n\n  function LevelManager(props) {\n    this.data = props.data;\n    this.app = props.app;\n  }\n\n  LevelManager.prototype.buildLevel = function(name) {\n    if (!gameData.levels[name]) {\n      return null;\n    }\n    var levelData = gameData.levels[name];\n    var name = levelData.name;\n    var worldRectData = levelData.worldRect;\n    var playerData = levelData.player;\n    var platformsData = levelData.platforms;\n    var ennemiesData = levelData.ennemies;\n    var skillsData = levelData.skills;\n\n    level.name = name;\n    level.countdownStart = levelData.countdownStart;\n    level.worldRect = new SDK.Rectangle({\n      x: worldRectData.props.x,\n      y: worldRectData.props.y,\n      width: worldRectData.props.width,\n      height: worldRectData.props.height\n    });\n    level.player = new gameEntityConstructors[playerData.type](\n      playerData.props\n    );\n    level.platforms = [];\n    platformsData.forEach(function(platform) {\n      level.platforms.push(\n        new gameEntityConstructors[platform.type](platform.props)\n      );\n    });\n    level.ennemies = [];\n    ennemiesData.forEach(function(ennemy) {\n      level.ennemies.push(\n        new gameEntityConstructors[ennemy.type](ennemy.props.x, ennemy.props.y)\n      );\n    });\n    level.skills = [];\n    skillsData.forEach(function(skill) {\n      level.skills.push(new gameEntityConstructors[skill.type](skill.props));\n    });\n\n    // temporary objects\n    level.lasers = [];\n    level.particles = [];\n\n    return level;\n  };\n\n  /**\n   * Put all level entities inside a single array.\n   * @param {Array} extra\n   */\n  LevelManager.prototype.buildEntities = function(extra) {\n    level.entities = []\n      .concat(level.platforms)\n      .concat(level.skills)\n      .concat(level.ennemies)\n      .concat(level.lasers)\n      .concat([level.player]);\n\n    if (extra) {\n      level.entities = level.entities.concat(extra);\n    }\n  };\n\n  LevelManager.prototype.deleteLevel = function(name) {\n    delete gameData.levels[name];\n  };\n\n  return LevelManager;\n})();\n\nmodule.exports = LevelManager;\n","var Shield = (function() {\n  var MIN_SIZE = 0;\n  var MAX_SIZE = 40;\n\n  function Shield(props) {\n    this.shielded = props.shielded || null; // object benefitting from the shield\n    this.r = MIN_SIZE;\n    this.isOpen = false;\n    this.isAnimating = false;\n\n    // timings\n    this.openingDuration = 0.3;\n    this.closingDuration = 0.6;\n\n    // hit points\n    this.hitPoints = 200;\n\n    // sounds\n    this.sounds = {\n      open: new SDK.Sound(\"./assets/sounds/Open.mp3\", 0.1),\n      close: new SDK.Sound(\"./assets/sounds/Close.mp3\", 0.2)\n    };\n  }\n\n  Shield.prototype.getBoundingRect = function() {\n    var shielded = this.shielded;\n    return new SDK.Rectangle({\n      x: shielded.left - this.r,\n      y: shielded.top - this.r,\n      width: shielded.width + this.r * 2,\n      height: shielded.height + this.r * 2\n    });\n  };\n\n  Shield.prototype.open = function() {\n    this.sounds.close.stop();\n    this.sounds.open.play();\n    this.isOpen = true;\n    this.isAnimating = true;\n  };\n\n  Shield.prototype.close = function() {\n    this.sounds.open.stop();\n    this.sounds.close.play();\n    this.isOpen = false;\n    this.isAnimating = true;\n  };\n\n  Shield.prototype.update = function() {\n    var dr;\n    if (this.isOpen) {\n      dr = ((MAX_SIZE - MIN_SIZE) / this.openingDuration) * dt;\n      // shield opening\n      if (this.r + dr < MAX_SIZE) {\n        this.r += dr;\n      } else {\n        this.r = MAX_SIZE;\n        this.isAnimating = false;\n      }\n    } else {\n      dr = ((MAX_SIZE - MIN_SIZE) / this.closingDuration) * dt;\n      // shield closing\n      if (this.r - dr > MIN_SIZE) {\n        this.r -= dr;\n      } else {\n        this.r = MIN_SIZE;\n        this.isAnimating = false;\n      }\n    }\n  };\n\n  Shield.prototype.hasCollisionWithLaser = function(laser) {\n    var boundingRect = this.getBoundingRect();\n    var collision = SDK.physics.collision;\n    var shielded = this.shielded;\n    var r = this.r;\n\n    // return if the two shapes bounding rectangles don't collide\n    if (\n      !collision.RectangleWithRectangle(boundingRect, laser.getBoundingRect())\n    ) {\n      return false;\n    }\n\n    // the shield can be decomposed in 6 shapes\n    c1 = new SDK.Circle({ x: shielded.left, y: shielded.top, r: r });\n    c2 = new SDK.Circle({ x: shielded.right, y: shielded.top, r: r });\n    c3 = new SDK.Circle({ x: shielded.right, y: shielded.bottom, r: r });\n    c4 = new SDK.Circle({ x: shielded.left, y: shielded.bottom, r: r });\n    r1 = new SDK.Rectangle({\n      x: shielded.left - r,\n      y: shielded.top,\n      width: shielded.width + 2 * r,\n      height: shielded.height\n    });\n    r2 = new SDK.Rectangle({\n      x: shielded.left,\n      y: shielded.top - r,\n      width: shielded.width,\n      height: shielded.height + 2 * r\n    });\n\n    return (\n      c1.containsPoint(laser.A.x, laser.A.y) ||\n      c1.containsPoint(laser.B.x, laser.B.y) ||\n      c2.containsPoint(laser.A.x, laser.A.y) ||\n      c2.containsPoint(laser.B.x, laser.B.y) ||\n      c3.containsPoint(laser.A.x, laser.A.y) ||\n      c3.containsPoint(laser.B.x, laser.B.y) ||\n      c4.containsPoint(laser.A.x, laser.A.y) ||\n      c4.containsPoint(laser.B.x, laser.B.y) ||\n      r1.contains(laser.A.x, laser.A.y) ||\n      r1.contains(laser.B.x, laser.B.y) ||\n      r2.contains(laser.A.x, laser.A.y) ||\n      r2.contains(laser.B.x, laser.B.y)\n    );\n  };\n\n  Shield.prototype.draw = function(ctx, camera) {\n    var left = this.shielded.x - this.r;\n    var top = this.shielded.y - this.r;\n    var right = left + 2 * this.r + this.shielded.width;\n    var bottom = top + 2 * this.r + this.shielded.height;\n    var lineWidth = 2;\n\n    ctx.save();\n    ctx.fillStyle = \"rgba(255, 255, 255, 0.4)\";\n    ctx.strokeStyle = this.shielded.color;\n    ctx.lineWidth = camera.applyToDistance(lineWidth);\n    ctx.beginPath();\n    ctx.moveTo(camera.applyToX(left), camera.applyToY(top + this.r));\n    ctx.arcTo(\n      camera.applyToX(left),\n      camera.applyToY(top),\n      camera.applyToX(left + this.r),\n      camera.applyToY(top),\n      camera.applyToDistance(this.r)\n    );\n    ctx.lineTo(camera.applyToX(right - this.r), camera.applyToY(top));\n    ctx.arcTo(\n      camera.applyToX(right),\n      camera.applyToY(top),\n      camera.applyToX(right),\n      camera.applyToY(top + this.r),\n      camera.applyToDistance(this.r)\n    );\n    ctx.lineTo(camera.applyToX(right), camera.applyToY(bottom - this.r));\n    ctx.arcTo(\n      camera.applyToX(right),\n      camera.applyToY(bottom),\n      camera.applyToX(right - this.r),\n      camera.applyToY(bottom),\n      camera.applyToDistance(this.r)\n    );\n    ctx.lineTo(camera.applyToX(left + this.r), camera.applyToY(bottom));\n    ctx.arcTo(\n      camera.applyToX(left),\n      camera.applyToY(bottom),\n      camera.applyToX(left),\n      camera.applyToY(bottom - this.r),\n      camera.applyToDistance(this.r)\n    );\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n    ctx.restore();\n  };\n\n  return Shield;\n})();\n\nmodule.exports = Shield;\n","var SmokeParticle = (function() {\n  function SmokeParticle(props) {\n    SDK.Particle.call(this, props);\n\n    this.image = new Image();\n    this.image.src = \"./assets/images/smoke2.png\";\n  }\n\n  SmokeParticle.prototype = Object.create(SDK.Particle.prototype);\n  SmokeParticle.prototype.constructor = SmokeParticle;\n\n  SmokeParticle.prototype.draw = function(ctx, camera) {\n    ctx.globalAlpha = Math.max(\n      0,\n      1 - (Date.now() - this.createdAt) / this.maxLife\n    );\n    ctx.save();\n    ctx.drawImage(\n      this.image,\n      camera.applyToX(this.x),\n      camera.applyToY(this.y),\n      camera.applyToDistance(this.size),\n      camera.applyToDistance(this.size)\n    );\n    ctx.restore();\n  };\n  return SmokeParticle;\n})();\n\nmodule.exports = SmokeParticle;\n","var Laser = (function() {\n  function Laser(props) {\n    this.length = 20;\n    var A = new SDK.Vector(props.x, props.y);\n    var B = SDK.Vector.sum(A, props.direction.scale(this.length));\n    SDK.Segment.call(this, A, B);\n\n    this.origin = new SDK.Vector(props.x, props.y);\n    this.speed = 250;\n    this.v = SDK.Vector.subtract(B, A)\n      .getUnitVector()\n      .scale(this.speed);\n\n    // stats\n    this.damage = props.damage;\n\n    // timings\n    this.createdAt = Date.now();\n    this.range = props.range;\n\n    this.color = props.color;\n  }\n\n  Laser.prototype = Object.create(SDK.Segment.prototype);\n  Laser.prototype.constructor = Laser;\n\n  Laser.prototype.hasReachedMaxRange = function() {\n    return (\n      SDK.Vector.subtract(this.B, this.origin).normSquared >=\n      Math.pow(this.range, 2)\n    );\n  };\n\n  Laser.prototype.update = function() {\n    var dPos = this.v.scale(dt);\n    this.A = SDK.Vector.sum(this.A, dPos);\n    this.B = SDK.Vector.sum(this.B, dPos);\n  };\n\n  Laser.prototype.draw = function(ctx, camera) {\n    var lineWidth = 3;\n    ctx.save();\n    ctx.strokeStyle = this.color;\n    ctx.lineWidth = camera.applyToDistance(lineWidth);\n    ctx.beginPath();\n    ctx.moveTo(camera.applyToX(this.A.x), camera.applyToY(this.A.y));\n    ctx.lineTo(camera.applyToX(this.B.x), camera.applyToY(this.B.y));\n    ctx.stroke();\n    ctx.restore();\n  };\n\n  return Laser;\n})();\n\nmodule.exports = Laser;\n","var Skill = (function() {\n  function Skill(props) {\n    SDK.Rectangle.call(this, props);\n\n    this.v = new SDK.Vector();\n    this.solid = false;\n    this.image = new Image();\n    this.image.src = props.src;\n  }\n\n  Skill.prototype = Object.create(SDK.Rectangle.prototype);\n  Skill.prototype.constructor = Skill;\n\n  Skill.prototype.update = function() {};\n\n  Skill.prototype.draw = function(ctx, camera) {\n    ctx.save();\n    ctx.drawImage(\n      this.image,\n      camera.applyToX(this.x),\n      camera.applyToY(this.y),\n      camera.applyToDistance(this.width),\n      camera.applyToDistance(this.height)\n    );\n    ctx.restore();\n  };\n\n  return Skill;\n})();\n\nmodule.exports = Skill;\n","var LevelEditor = require(\"./levelEditor/gameLevelEditor\");\n\nwindow.addEventListener(\"DOMContentLoaded\", function() {\n  function fitCanvasToContainer() {\n    var canvases = document.getElementsByTagName(\"canvas\");\n    for (var i = 0; i < canvases.length; i++) {\n      var canvas = canvases[i];\n      canvas.setAttribute(\n        \"width\",\n        parseFloat(window.getComputedStyle(canvas).width)\n      );\n      canvas.setAttribute(\n        \"height\",\n        parseFloat(window.getComputedStyle(canvas).height)\n      );\n    }\n  }\n  window.addEventListener(\"resize\", fitCanvasToContainer);\n  fitCanvasToContainer();\n\n  // start level editor\n  window.levelEditor = new LevelEditor();\n  levelEditor.init({\n    rulers: true\n  });\n  levelEditor.start();\n});\n","var CreationTool = require(\"./creationTool\");\nvar SelectionTool = require(\"./selectionTool\");\nvar KeyboardManager = require(\"./keyboardManager\");\nvar LevelManager = require(\"../game/levelManager\");\nvar Toolbar = require(\"./toolbar\");\nvar ToolManager = require(\"./toolManager\");\nvar utils = require('../utils');\nwindow.gameData = require(\"../game/gameData.json\");\n\nvar LevelEditor = (function() {\n  function LevelEditor(options) {\n    this.data = {};\n  }\n\n  LevelEditor.prototype.init = function(config) {\n    this.displayRulers =\n      config.displayRulers !== undefined\n        ? config.displayRulers\n        : true;\n    this.canvas = document.getElementById(\"canvas\");\n    this.ctx = canvas.getContext(\"2d\");\n    this.keyboard = new KeyboardManager(this);\n    this.mouse = new SDK.MouseManager(this);\n    this.soundManager = new SDK.SoundManager(gameData);\n    this.levelManager = new LevelManager(this);\n    this.gameObjects = [];\n    this.camera = new SDK.Camera({\n      zoomLevel: 0.05,\n      worldRect: this.worldRect,\n      canvas: this.canvas\n    });\n    this.grid = new SDK.Grid({\n      options: {\n        displayRulers: config.displayRulers,\n        isGame: false\n      },\n      camera: this.camera,\n      canvas: this.canvas,\n      mouse: this.mouse\n    });\n    this.selectionTool = new SelectionTool({\n      gameObjects: this.gameObjects,\n      camera: this.camera,\n      mouse: this.mouse,\n      grid: this.grid,\n      canvas: this.canvas\n    });\n    this.creationTool = new CreationTool({\n      gameObjects: this.gameObjects,\n      camera: this.camera,\n      mouse: this.mouse,\n      grid: this.grid,\n      canvas: this.canvas\n    });\n    this.tools = {\n      0: this.selectionTool,\n      1: this.creationTool\n    };\n    this.toolManager = new ToolManager({\n      mouse: this.mouse,\n      canvas: this.canvas,\n      tools: this.tools\n    });\n    this.toolbar = new Toolbar({ app: this, tools: this.tools });\n  };\n\n  LevelEditor.prototype.loadGameDataFromLocalStorage = function() {\n    var savedData = localStorage.getItem(\"gameData\");\n    if (savedData) {\n      gameData = JSON.parse(savedData);\n    }\n  };\n\n  LevelEditor.prototype.buildLevel = function(name) {\n    this.level = this.levelManager.buildLevel(name);\n    this.countdownStart = this.level.countdownStart;\n    this.worldRect = this.level.worldRect;\n    this.gameObjects.length = 0; // clear the array without reassigning\n    Array.prototype.push.apply(\n      this.gameObjects,\n      [].concat(\n        this.level.player,\n        this.level.platforms,\n        this.level.ennemies,\n        this.level.skills\n      )\n    );\n    this.updateToolbar();\n  };\n\n  LevelEditor.prototype.updateToolbar = function() {\n    utils.emptyElement(this.toolbar.loadLevelSelect);\n    var levelSelectionOptions = [utils.h(\"option\", { value: \"\" }, \"\")].concat(\n      Object.keys(gameData.levels).map(function(item) {\n        return utils.h(\"option\", { id: item, value: item }, item);\n      })\n    );\n    levelSelectionOptions.forEach(function(option) {\n      this.toolbar.loadLevelSelect.appendChild(utils.render(option));\n    }, this);\n    if (this.level) {\n      this.toolbar.loadLevelSelect.value = this.level.name;\n      this.toolbar.levelNameInput.value = this.level.name;\n      this.toolbar.countdownInput.value = this.level.countdownStart;\n      this.toolbar.worldXInput.value = this.level.worldRect.x;\n      this.toolbar.worldYInput.value = this.level.worldRect.y;\n      this.toolbar.worldWidthInput.value = this.level.worldRect.width;\n      this.toolbar.worldHeightInput.value = this.level.worldRect.height;\n    }\n  };\n\n  LevelEditor.prototype.handleKeyboard = function() {};\n\n  LevelEditor.prototype.updateScene = function() {\n    this.camera.update();\n  };\n\n  LevelEditor.prototype.renderBackground = function(ctx) {\n    this.fillCanvas(ctx, \"#111\");\n    ctx.save();\n    for (var i = 0; i < this.starCount; i++) {\n      var star = this.stars[i];\n      ctx.fillStyle = \"rgba(255, 255, 255, \" + star.opacity + \")\";\n      ctx.beginPath();\n      ctx.arc(\n        (star.x - this.camera.x * 0.3 + this.canvas.width) % this.canvas.width,\n        (star.y - this.camera.y * 0.3 + this.canvas.height) %\n          this.canvas.height,\n        star.r,\n        0,\n        Math.PI * 2\n      );\n      ctx.fill();\n    }\n    ctx.restore();\n  };\n\n  LevelEditor.prototype.updateTimeEllapsed = function() {\n    this.previousTime = this.currentTime || Date.now();\n    this.currentTime = Date.now();\n    return (this.currentTime - this.previousTime) / 1000;\n  };\n\n  LevelEditor.prototype.clearCanvas = function(ctx) {\n    ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n  };\n\n  LevelEditor.prototype.fillCanvas = function(ctx, color) {\n    ctx.fillStyle = color;\n    ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\n  };\n\n  LevelEditor.prototype.drawGrid = function(ctx) {\n    this.grid.draw(ctx, this.camera, {\n      displayRulers: this.displayRulers\n    });\n  };\n\n  LevelEditor.prototype.drawSelectionRectangle = function(ctx, camera) {\n    var selectionArea = this.selectionTool.selectionArea;\n    if (selectionArea) {\n      ctx.save();\n      ctx.fillStyle = \"rgba(255, 255, 255, 0.5)\";\n      ctx.fillRect(\n        camera.applyToX(selectionArea.x),\n        camera.applyToY(selectionArea.y),\n        camera.applyToDistance(selectionArea.width),\n        camera.applyToDistance(selectionArea.height)\n      );\n      ctx.restore();\n    }\n  };\n\n  LevelEditor.prototype.drawSelectionOutlines = function(ctx, camera) {\n    var selectedObjects = this.selectionTool.selection.map(function(item) {\n      return item.object;\n    });\n\n    if (!selectedObjects || selectedObjects.length === 0) return;\n\n    var selectionRectangle = this.selectionTool.getSelectionBoundingRect();\n    var lineWidth = 1;\n\n    ctx.save();\n    ctx.strokeStyle = \"white\";\n    ctx.lineWidth = lineWidth; // do not scale line width for visibility reasons\n    ctx.beginPath();\n    ctx.rect(\n      camera.applyToX(selectionRectangle.x),\n      camera.applyToY(selectionRectangle.y),\n      camera.applyToDistance(selectionRectangle.width),\n      camera.applyToDistance(selectionRectangle.height)\n    );\n    ctx.stroke();\n\n    selectedObjects.forEach(function(selectedObject) {\n      ctx.beginPath();\n      ctx.rect(\n        camera.applyToX(selectedObject.x) - lineWidth / 2,\n        camera.applyToY(selectedObject.y) - lineWidth / 2,\n        camera.applyToDistance(selectedObject.width) + lineWidth,\n        camera.applyToDistance(selectedObject.height) + lineWidth\n      );\n      ctx.stroke();\n    });\n    ctx.restore();\n  };\n\n  LevelEditor.prototype.drawResizeHandles = function(ctx, camera) {\n    if (!this.selectionTool.selection.length) {\n      return;\n    }\n\n    var selectionRectangle = this.selectionTool.getSelectionBoundingRect();\n\n    ctx.save();\n    ctx.fillStyle = this.tools[0].resizeHandleHovered ? \"cyan\" : \"blue\";\n    ctx.fillRect(\n      camera.applyToX(selectionRectangle.right),\n      camera.applyToY(selectionRectangle.bottom),\n      20,\n      20\n    );\n    ctx.restore();\n  };\n\n  LevelEditor.prototype.renderScene = function(ctx, camera) {\n    // optimize rendering by only drawing objects that are on screen\n    this.drawGrid(ctx, camera);\n\n    // draw game objects\n    this.gameObjects.forEach(function(gameObject) {\n      gameObject.getBoundingRect().overlaps(camera) &&\n        gameObject.draw(ctx, camera);\n\n      // draw the end state of moving platforms\n      if (gameObject.constructor.name === \"MovingPlatform\") {\n        ctx.save();\n        var lineWidth = 2;\n        ctx.globalAlpha = 0.4;\n        ctx.strokeStyle = gameObject.color;\n        ctx.strokeStyle = \"red\";\n        ctx.fillStyle = \"rgb(255, 255, 255)\";\n        ctx.lineWidth = lineWidth;\n        ctx.beginPath();\n        ctx.rect(\n          camera.applyToX(gameObject.xEnd) + lineWidth / 2,\n          camera.applyToY(gameObject.yEnd) + lineWidth / 2,\n          camera.applyToDistance(gameObject.width) - lineWidth,\n          camera.applyToDistance(gameObject.height) - lineWidth\n        );\n        ctx.stroke();\n        ctx.fill();\n\n        ctx.strokeStyle = \"red\";\n        ctx.lineWidth = 2;\n        ctx.beginPath();\n        ctx.moveTo(\n          camera.applyToX(gameObject.center.x),\n          camera.applyToY(gameObject.center.y)\n        );\n        ctx.lineTo(\n          camera.applyToX(gameObject.xEnd + gameObject.width / 2),\n          camera.applyToY(gameObject.yEnd + gameObject.height / 2)\n        );\n        ctx.stroke();\n        ctx.restore();\n      }\n    });\n\n    // draw selection rectangle\n    this.drawSelectionRectangle(ctx, camera);\n    this.drawSelectionOutlines(ctx, camera);\n    this.drawResizeHandles(ctx, camera);\n\n    // draw worldRect\n    ctx.save();\n    ctx.strokeStyle = \"red\";\n    ctx.beginPath();\n    ctx.strokeRect(\n      camera.applyToX(this.worldRect.x),\n      camera.applyToY(this.worldRect.y),\n      camera.applyToDistance(this.worldRect.width),\n      camera.applyToDistance(this.worldRect.height)\n    );\n    ctx.stroke();\n\n    ctx.restore();\n  };\n\n  LevelEditor.prototype.start = function() {\n    // initialize world size\n    this.worldRect = new SDK.Rectangle({\n      x: -5000,\n      y: -5000,\n      width: 10000,\n      height: 10000\n    });\n    this.camera.updateDimensions();\n    this.camera.x = this.worldRect.center.x - this.camera.width / 2;\n    this.camera.y = this.worldRect.center.y - this.camera.height / 2;\n\n    // local storage\n    this.loadGameDataFromLocalStorage();\n    // this.buildLevel();\n    this.updateToolbar();\n    this.main();\n  };\n\n  LevelEditor.prototype.main = function() {\n    var camera = this.camera;\n    dt = this.updateTimeEllapsed();\n    // this.handleKeyboard();\n    this.updateScene();\n    this.clearCanvas(this.ctx, camera);\n    this.renderBackground(this.ctx, camera);\n    this.renderScene(this.ctx, camera);\n\n    requestAnimationFrame(this.main.bind(this));\n  };\n\n  LevelEditor.prototype.generateJSONdata = function() {\n    var gameObjects = this.gameObjects;\n\n    // level name\n    this.data.name = this.toolbar.levelNameInput.value;\n\n    // level name\n    this.data.countdownStart = parseInt(this.toolbar.countdownInput.value);\n\n    // worldRect\n    this.data.worldRect = {\n      type: \"Rectangle\",\n      props: {\n        x: this.worldRect.x,\n        y: this.worldRect.y,\n        width: this.worldRect.width,\n        height: this.worldRect.height\n      }\n    };\n\n    // player\n    var player = gameObjects.filter(function(gameObject) {\n      return gameObject.constructor.name === \"Player\";\n    })[0];\n    if (!player) {\n      alert(\"You must add at least one player\");\n      return false;\n    }\n    this.data.player = player\n      ? {\n          type: \"Player\",\n          props: {\n            x: player.x,\n            y: player.y,\n            color: player.color\n          }\n        }\n      : null;\n\n    // platforms\n    this.data.platforms = [];\n    var platforms = gameObjects.filter(function(gameObject) {\n      return (\n        gameObject.constructor.name === \"Platform\" ||\n        gameObject.constructor.name === \"MovingPlatform\"\n      );\n    });\n    platforms.forEach(function(gameObject) {\n      var constructorName = gameObject.constructor.name;\n      var platformData = {\n        type: constructorName,\n        props: {\n          width: gameObject.width,\n          height: gameObject.height\n        }\n      };\n      platformData.props.x = gameObject.x;\n      platformData.props.y = gameObject.y;\n\n      if (constructorName === \"MovingPlatform\") {\n        platformData.props.xStart = gameObject.xStart;\n        platformData.props.yStart = gameObject.yStart;\n        platformData.props.xEnd = gameObject.xEnd;\n        platformData.props.yEnd = gameObject.yEnd;\n      }\n      this.data.platforms.push(platformData);\n    }, this);\n\n    // ennemies\n    this.data.ennemies = [];\n    var ennemies = gameObjects.filter(function(gameObject) {\n      return gameObject.constructor.name === \"Ennemy\";\n    });\n    ennemies.forEach(function(ennemy) {\n      var ennemyData = {\n        type: \"Ennemy\",\n        props: {\n          x: ennemy.x,\n          y: ennemy.y,\n          width: ennemy.width,\n          height: ennemy.height\n        }\n      };\n      this.data.ennemies.push(ennemyData);\n    }, this);\n\n    // skills\n    this.data.skills = [];\n    var skills = gameObjects.filter(function(gameObject) {\n      return gameObject.constructor.name.startsWith(\"Skill\");\n    });\n    skills.forEach(function(skill) {\n      var skillData = {\n        type: skill.constructor.name,\n        props: {\n          x: skill.x,\n          y: skill.y,\n          width: skill.width,\n          height: skill.height\n        }\n      };\n      this.data.skills.push(skillData);\n    }, this);\n\n    return true;\n  };\n\n  LevelEditor.prototype.saveToLocalStorage = function() {\n    if (this.generateJSONdata()) {\n      gameData.levels[this.data.name] = this.data;\n      var json = JSON.stringify(gameData);\n      localStorage.setItem(\"gameData\", json);\n      this.updateToolbar();\n    }\n  };\n\n  return LevelEditor;\n})();\n\nmodule.exports = LevelEditor;\n","var CreationTool = (function() {\n  var defaultOptions = {\n    Player: {},\n    Ennemy: {},\n    Skill: {},\n    Platform: {\n      passthrough: false\n    },\n    MovingPlatform: {\n      passthrough: false,\n      positionRatio: 0\n    }\n  };\n\n  function CreationTool(props) {\n    this.gameObjects = props.gameObjects;\n    this.camera = props.camera;\n    this.mouse = props.mouse;\n    this.grid = props.grid;\n    this.canvas = props.canvas;\n\n    this.handleMouseDown = this.handleMouseDown.bind(this);\n    this.handleMouseUp = this.handleMouseUp.bind(this);\n    this.handleMouseMove = this.handleMouseMove.bind(this);\n\n    this.eventHandlers = {\n      mouse: {\n        mousedown: {\n          handler: this.handleMouseDown,\n          props: undefined\n        },\n        mouseup: {\n          handler: this.handleMouseUp,\n          props: undefined\n        },\n        mousemove: {\n          handler: this.handleMouseMove,\n          props: undefined\n        }\n      }\n    };\n  }\n\n  CreationTool.prototype.handleMouseDown = function handleMouseDown(e) {\n    var mouseGamePosSnappedToGrid = this.grid.getMouseGamePosSnappedToGrid(\n      this.mouse.x,\n      this.mouse.y\n    );\n\n    switch (e.button) {\n      case 0:\n        // left mouse button\n        var Constructor = this.gameObjectConstructor;\n        var gameObject = new Constructor({\n          x: mouseGamePosSnappedToGrid.x,\n          y: mouseGamePosSnappedToGrid.y\n        });\n        this.gameObjects.push(gameObject);\n        switch (Constructor.name) {\n          case \"Platform\":\n          case \"MovingPlatform\":\n            this.currentObject = gameObject;\n            break;\n          default:\n            this.currentObject = null;\n            break;\n        }\n        break;\n      default:\n        break;\n    }\n  };\n\n  CreationTool.prototype.handleMouseUp = function handleMouseUp(e) {\n    switch (e.button) {\n      case 0: // left mouse button\n        this.canvas.style.cursor = \"\";\n        break;\n      case 2: // right mouse button\n        this.clickedObject = null;\n        break;\n      default:\n        break;\n    }\n  };\n\n  CreationTool.prototype.handleMouseMove = function handleMouseMove(e) {\n    var clickGamePosSnappedToGrid = this.grid.getMouseGamePosSnappedToGrid(\n      this.mouse.clickX,\n      this.mouse.clickY\n    );\n    var mouseGamePosSnappedToGrid = this.grid.getMouseGamePosSnappedToGrid(\n      this.mouse.x,\n      this.mouse.y\n    );\n    var mouseGameDisplacement = SDK.Vector.subtract(\n      mouseGamePosSnappedToGrid,\n      clickGamePosSnappedToGrid\n    );\n\n    // move this.camera when mouse wheel is held down\n    if (this.mouse.buttons[0]) {\n      if (this.currentObject) {\n        this.currentObject.width = Math.max(0, mouseGameDisplacement.x);\n        this.currentObject.height = Math.max(0, mouseGameDisplacement.y);\n      }\n    }\n  };\n\n  return CreationTool;\n})();\n\nmodule.exports = CreationTool;\n","var SelectionTool = (function() {\n  function SelectionTool(props) {\n    this.gameObjects = props.gameObjects;\n    this.camera = props.camera;\n    this.mouse = props.mouse;\n    this.grid = props.grid;\n    this.canvas = props.canvas;\n\n    this.selection = [];\n    this.clickedObject = null;\n    this.selectionArea = null;\n\n    this.handleMouseDown = this.handleMouseDown.bind(this);\n    this.handleMouseUp = this.handleMouseUp.bind(this);\n    this.handleMouseMove = this.handleMouseMove.bind(this);\n\n    this.eventHandlers = {\n      mouse: {\n        mousedown: {\n          handler: this.handleMouseDown,\n          props: undefined\n        },\n        mouseup: {\n          handler: this.handleMouseUp,\n          props: undefined\n        },\n        mousemove: {\n          handler: this.handleMouseMove,\n          props: undefined\n        }\n      }\n    };\n  }\n\n  SelectionTool.prototype.getSelectionBoundingRect = function() {\n    var selectedObjects = this.selection.map(function(item) {\n      return item.object;\n    });\n    var left = Math.min.apply(\n      null,\n      selectedObjects.map(function(obj) {\n        return obj.getBoundingRect().left;\n      })\n    );\n    var top = Math.min.apply(\n      null,\n      selectedObjects.map(function(obj) {\n        return obj.getBoundingRect().top;\n      })\n    );\n    var width =\n      Math.max.apply(\n        null,\n        selectedObjects.map(function(obj) {\n          return obj.getBoundingRect().right;\n        })\n      ) - left;\n    var height =\n      Math.max.apply(\n        null,\n        selectedObjects.map(function(obj) {\n          return obj.getBoundingRect().bottom;\n        })\n      ) - top;\n    return new SDK.Rectangle({ x: left, y: top, width: width, height: height });\n  };\n\n  SelectionTool.prototype.handleMouseDown = function handleMouseDown(e) {\n    var mouseGamePosSnappedToGrid = this.grid.getMouseGamePosSnappedToGrid(\n      this.mouse.x,\n      this.mouse.y\n    );\n    var newSelection = [];\n\n    switch (e.button) {\n      case 0:\n        // check if the player clicked a resize handle\n        this.resizeHandleClicked = this.isMouseInsideResizeHandle();\n        if (this.resizeHandleClicked) return;\n\n        // find the most recently added game object the click was inside of\n        this.clickedObject = this.getClickedObject(\n          mouseGamePosSnappedToGrid.x,\n          mouseGamePosSnappedToGrid.y\n        );\n\n        if (this.clickedObject) {\n          newSelection = [\n            {\n              object: this.clickedObject,\n              objectStart: Object.assign({}, this.clickedObject) // copy\n            }\n          ];\n        }\n\n        // check if clicked object already belongs to a previous selection\n        var selectionObjects = this.selection.map(function(item) {\n          return item.object;\n        });\n        if (\n          this.clickedObject &&\n          selectionObjects.includes(this.clickedObject)\n        ) {\n          newSelection = this.selection;\n        }\n\n        this.selection = newSelection;\n\n        // create selection area if no object was selected\n        if (!this.clickedObject) {\n          this.selectionArea = new SDK.Rectangle({\n            x: mouseGamePosSnappedToGrid.x,\n            y: mouseGamePosSnappedToGrid.y\n          });\n        }\n        break;\n      case 2:\n        var clickedObject = this.getClickedObject(\n          mouseGamePosSnappedToGrid.x,\n          mouseGamePosSnappedToGrid.y\n        );\n        if (\n          clickedObject &&\n          clickedObject.constructor.name === \"MovingPlatform\"\n        ) {\n          this.clickedObject = clickedObject;\n        }\n        break;\n      default:\n        break;\n    }\n  };\n\n  SelectionTool.prototype.isMouseInsideResizeHandle = function() {\n    if (this.selection) {\n      var selectionRectangle = this.getSelectionBoundingRect();\n      var resizeHandlePos = this.camera.apply(\n        selectionRectangle.right,\n        selectionRectangle.bottom\n      );\n      var resizeHandleRectangle = new SDK.Rectangle({\n        x: resizeHandlePos.x,\n        y: resizeHandlePos.y,\n        width: 20,\n        height: 20\n      });\n\n      return resizeHandleRectangle.contains(this.mouse.x, this.mouse.y);\n    }\n  };\n\n  SelectionTool.prototype.getClickedObject = function(x, y) {\n    var clickedObject = null;\n    for (var i = 0; i < this.gameObjects.length; i++) {\n      var gameObject = this.gameObjects[i];\n      if (gameObject.getBoundingRect().contains(x, y)) {\n        clickedObject = gameObject;\n      }\n    }\n    return clickedObject;\n  };\n\n  SelectionTool.prototype.handleMouseMove = function handleMouseMove(e) {\n    var clickGamePosSnappedToGrid = this.grid.getMouseGamePosSnappedToGrid(\n      this.mouse.clickX,\n      this.mouse.clickY\n    );\n    var mouseGamePosSnappedToGrid = this.grid.getMouseGamePosSnappedToGrid(\n      this.mouse.x,\n      this.mouse.y\n    );\n    var mouseGameDisplacement = SDK.Vector.subtract(\n      mouseGamePosSnappedToGrid,\n      clickGamePosSnappedToGrid\n    );\n    // no button down and mouse is inside a resize handle\n    if (\n      !this.mouse.buttons[0] &&\n      !this.mouse.buttons[1] &&\n      !this.mouse.buttons[2]\n    ) {\n      this.resizeHandleHovered = this.isMouseInsideResizeHandle();\n      return;\n    }\n    // left button down\n    if (this.mouse.buttons[0]) {\n      // resize selection objects if resize handle was clicked\n      if (this.resizeHandleClicked) {\n        this.resizeSelectedObjects(\n          mouseGameDisplacement.x,\n          mouseGameDisplacement.y\n        );\n        return;\n      }\n      if (this.selectionArea) {\n        this.selectionArea.width = mouseGameDisplacement.x;\n        this.selectionArea.height = mouseGameDisplacement.y;\n      } else {\n        this.moveSelectedObjects(\n          mouseGameDisplacement.x,\n          mouseGameDisplacement.y\n        );\n      }\n    }\n    // right button down\n    if (this.mouse.buttons[2]) {\n      if (this.clickedObject) {\n        this.clickedObject.xEnd =\n          this.clickedObject.xStart + mouseGameDisplacement.x;\n        this.clickedObject.yEnd =\n          this.clickedObject.yStart + mouseGameDisplacement.y;\n      }\n    }\n  };\n\n  SelectionTool.prototype.resizeSelectedObjects = function(dx, dy) {\n    this.selection.forEach(function(item) {\n      item.object.width = item.objectStart.width + dx;\n      item.object.height = item.objectStart.height + dy;\n    });\n  };\n\n  SelectionTool.prototype.moveSelectedObjects = function(dx, dy) {\n    this.selection.forEach(function(item) {\n      item.object.x = item.objectStart.x + dx;\n      item.object.y = item.objectStart.y + dy;\n      item.object.xStart = item.objectStart.xStart + dx;\n      item.object.yStart = item.objectStart.yStart + dy;\n      item.object.xEnd = item.objectStart.xEnd + dx;\n      item.object.yEnd = item.objectStart.yEnd + dy;\n    });\n  };\n\n  SelectionTool.prototype.handleMouseUp = function handleMouseUp(e) {\n    switch (e.button) {\n      case 0: // left button up\n        if (this.resizeHandleClicked) {\n          this.resizeHandleClicked = false; // release handle\n          this.selection.forEach(function(item) {\n            item.objectStart.width = item.object.width;\n            item.objectStart.height = item.object.height;\n          });\n          return;\n        }\n\n        if (this.selection.length) {\n          if (\n            this.mouse.releaseX === this.mouse.clickX &&\n            this.mouse.releaseY === this.mouse.clickY\n          ) {\n            // If click and release at the same spot, select the most recently added game object the click was inside of\n            this.selection = [\n              {\n                object: this.clickedObject\n              }\n            ];\n          }\n\n          this.selection.forEach(function(item) {\n            item.objectStart = Object.assign({}, item.object);\n          });\n\n          return;\n        }\n\n        if (this.selectionArea) {\n          // which objects are in the selection area?\n          this.selection = [];\n          this.gameObjects.forEach(\n            function(obj) {\n              if (obj.getBoundingRect().overlaps(this.selectionArea)) {\n                this.selection.push({\n                  object: obj,\n                  objectStart: Object.assign({}, obj)\n                });\n              }\n            }.bind(this)\n          );\n          this.selectionArea = null;\n        }\n        break;\n      case 2:\n        if (this.selection.length && this.clickedObject) {\n          this.selection[0].objectStart.xEnd = this.clickedObject.xEnd;\n          this.selection[0].objectStart.yEnd = this.clickedObject.yEnd;\n        }\n        this.clickedObject = null;\n        break;\n      default:\n        break;\n    }\n  };\n\n  return SelectionTool;\n})();\n\nmodule.exports = SelectionTool;\n","var KeyboardManager = (function() {\n  function KeyboardManager(game) {\n    // reference to the game object\n    this.game = game;\n\n    var codeMappings = {\n      ArrowLeft: \"LEFT\",\n      ArrowUp: \"UP\",\n      ArrowRight: \"RIGHT\",\n      ArrowDown: \"DOWN\",\n      KeyW: \"UP\",\n      KeyA: \"LEFT\",\n      KeyS: \"DOWN\",\n      KeyD: \"RIGHT\",\n      Enter: \"ENTER\",\n      Space: \"SPACE\",\n      Escape: \"ESCAPE\"\n    };\n    var keyCodeMappings = {\n      37: \"LEFT\",\n      38: \"UP\",\n      39: \"RIGHT\",\n      40: \"DOWN\",\n      90: \"UP\",\n      81: \"LEFT\",\n      93: \"DOWN\",\n      68: \"RIGHT\",\n      13: \"ENTER\",\n      32: \"SPACE\",\n      27: \"ESCAPE\"\n    };\n\n    window.addEventListener(\"keydown\", this.handleKeydown.bind(this));\n\n    this.keyRepeat = {};\n  }\n\n  KeyboardManager.prototype.handleKeydown = function handleKeydown(event) {\n    var mouseGamePosSnappedToGrid = this.game.grid.getMouseGamePosSnappedToGrid(\n      this.game.mouse.x,\n      this.game.mouse.y\n    );\n\n    switch (event.keyCode) {\n      case 46: // Delete\n        var selection = this.game.tools[0].selection;\n        if (selection.length) {\n          while (selection[0]) {\n            var selectedObject = selection[0].object;\n            var gameObjectIndex = this.game.gameObjects.indexOf(selectedObject);\n            gameObjectIndex >= 0 &&\n              this.game.gameObjects.splice(gameObjectIndex, 1);\n            selection.shift();\n          }\n        }\n        break;\n      case 27: // Escape\n        this.game.tools[0].selection = [];\n        break;\n      case 65: // A key\n        this.game.toolManager.tool = 0; // switch to selection context\n        if (event.ctrlKey) {\n          event.preventDefault();\n          this.game.tools[0].selection = this.game.gameObjects.map(function(\n            obj\n          ) {\n            return {\n              object: obj,\n              objectStart: Object.assign({}, obj)\n            };\n          });\n        }\n        break;\n      case 83:\n        this.game.toolManager.tool = 0;\n        break;\n      case 67:\n        this.game.toolManager.tool = 1;\n        this.game.toolbar.objectTypeDropDown.focus();\n        break;\n      case 37:\n        this.game.camera.x -= 20 / this.game.camera.zoomLevel;\n        break;\n      case 38:\n        this.game.camera.y -= 20 / this.game.camera.zoomLevel;\n        break;\n      case 39:\n        this.game.camera.x += 20 / this.game.camera.zoomLevel;\n        break;\n      case 40:\n        this.game.camera.y += 20 / this.game.camera.zoomLevel;\n        break;\n      case 187:\n        event.preventDefault();\n        event.shiftKey\n          ? this.game.camera.zoomOut(\n              mouseGamePosSnappedToGrid.x,\n              mouseGamePosSnappedToGrid.y\n            )\n          : this.game.camera.zoomIn(\n              mouseGamePosSnappedToGrid.x,\n              mouseGamePosSnappedToGrid.y\n            );\n        break;\n      default:\n    }\n  };\n\n  return KeyboardManager;\n})();\n\nmodule.exports = KeyboardManager;\n","var Player = require(\"../game/player\");\nvar Ennemy = require(\"../game/ennemy\");\nvar Platform = require(\"../game/platform\");\nvar MovingPlatform = require(\"../game/movingPlatform\");\nvar skills = require(\"../game/skills\");\nvar SkillHtml = skills.SkillHtml;\nvar SkillCss = skills.SkillCss;\nvar SkillSass = skills.SkillSass;\nvar SkillBootstrap = skills.SkillBootstrap;\nvar SkillReact = skills.SkillReact;\nvar SkillAngular = skills.SkillAngular;\nvar SkillJquery = skills.SkillJquery;\nvar SkillNode = skills.SkillNode;\nvar SkillMongo = skills.SkillMongo;\nvar SkillMeteor = skills.SkillMeteor;\n\nvar Toolbar = (function() {\n  function Toolbar(props) {\n    this.el = document.getElementById(\"toolbar\");\n    this.loadLevelSelect = document.getElementById(\"load\");\n    this.levelNameInput = document.getElementById(\"level-name\");\n    this.countdownInput = document.getElementById(\"level-countdown\");\n    this.worldXInput = document.getElementById(\"world-x\");\n    this.worldYInput = document.getElementById(\"world-y\");\n    this.worldWidthInput = document.getElementById(\"world-width\");\n    this.worldHeightInput = document.getElementById(\"world-height\");\n    this.selectButton = document.getElementById(\"button-select\");\n    this.createButton = document.getElementById(\"button-create\");\n    this.objectTypeDropDown = document.getElementById(\"object-type\");\n    this.saveButton = document.getElementById(\"save-button\");\n    this.deleteButton = document.getElementById(\"delete-button\");\n\n    this.deleteButton.addEventListener(\n      \"click\",\n      function(e) {\n        e.preventDefault ? e.preventDefault() : (e.returnValue = false);\n        var currentLevelName = this.loadLevelSelect.value;\n        var confirmDelete = window.confirm(\n          \"Are you sure you want to delete the current level?\"\n        );\n        if (confirmDelete && gameData.levels[currentLevelName]) {\n          delete gameData.levels[currentLevelName];\n          localStorage.setItem(\"gameData\", JSON.stringify(gameData));\n          this.app.start();\n        }\n      }.bind(this)\n    );\n    this.loadLevelSelect.addEventListener(\n      \"change\",\n      function(e) {\n        e.preventDefault ? e.preventDefault() : (e.returnValue = false);\n        e.target.value === \"\" && this.app.start();\n        e.target.value !== \"\" && this.app.buildLevel(e.target.value);\n      }.bind(this)\n    );\n    this.worldXInput.addEventListener(\n      \"change\",\n      function(e) {\n        var app = this.app;\n        e.preventDefault ? e.preventDefault() : (e.returnValue = false);\n        app.worldRect.x = parseInt(e.target.value);\n      }.bind(this)\n    );\n    this.worldYInput.addEventListener(\n      \"change\",\n      function(e) {\n        var app = this.app;\n        e.preventDefault ? e.preventDefault() : (e.returnValue = false);\n        app.worldRect.y = parseInt(e.target.value);\n      }.bind(this)\n    );\n    this.worldWidthInput.addEventListener(\n      \"change\",\n      function(e) {\n        var app = this.app;\n        e.preventDefault ? e.preventDefault() : (e.returnValue = false);\n        app.worldRect.width = parseInt(e.target.value);\n      }.bind(this)\n    );\n    this.worldHeightInput.addEventListener(\n      \"change\",\n      function(e) {\n        var app = this.app;\n        e.preventDefault ? e.preventDefault() : (e.returnValue = false);\n        app.worldRect.height = parseInt(e.target.value);\n      }.bind(this)\n    );\n    this.selectButton.addEventListener(\n      \"click\",\n      function(e) {\n        var app = this.app;\n        e.preventDefault ? e.preventDefault() : (e.returnValue = false);\n        app.toolManager.tool = 0;\n      }.bind(this)\n    );\n    this.createButton.addEventListener(\n      \"click\",\n      function(e) {\n        var app = this.app;\n        e.preventDefault ? e.preventDefault() : (e.returnValue = false);\n        app.toolManager.tool = 1;\n      }.bind(this)\n    );\n    this.saveButton.addEventListener(\n      \"click\",\n      function(e) {\n        var app = this.app;\n        e.preventDefault ? e.preventDefault() : (e.returnValue = false);\n        app.saveToLocalStorage();\n      }.bind(this)\n    );\n\n    this.objectTypeDropDown.addEventListener(\n      \"change\",\n      function(e) {\n        e.preventDefault ? e.preventDefault() : (e.returnValue = false);\n        this.objectTypeDropDown.focus();\n        var app = this.app;\n        var objectType = this.getGameObjectType();\n        app.toolManager.tool = 1;\n        switch (objectType) {\n          case \"Player\":\n          case \"Ennemy\":\n          case \"SkillHtml\":\n          case \"SkillCss\":\n          case \"SkillSass\":\n          case \"SkillBootstrap\":\n          case \"SkillJquery\":\n          case \"SkillReact\":\n          case \"SkillAngular\":\n          case \"SkillMongo\":\n          case \"SkillNode\":\n          case \"SkillMeteor\":\n            app.toolManager.tool = 1;\n            break;\n          case \"Platform\":\n          case \"MovingPlatform\":\n            app.toolManager.tool = 2;\n            break;\n          default:\n            break;\n        }\n      }.bind(this)\n    );\n\n    this.tools = props.tools;\n    this.app = props.app;\n    this.getGameObjectType();\n  }\n\n  Toolbar.prototype.getGameObjectType = function() {\n    var app = this.app;\n    var type = this.objectTypeDropDown.value;\n    var objectTypeMap = {\n      player: Player,\n      platform: Platform,\n      movingPlatform: MovingPlatform,\n      ennemy: Ennemy,\n      skillHtml: SkillHtml,\n      skillCss: SkillCss,\n      skillSass: SkillSass,\n      skillBootstrap: SkillBootstrap,\n      skillJquery: SkillJquery,\n      skillReact: SkillReact,\n      skillAngular: SkillAngular,\n      skillNode: SkillNode,\n      skillMongo: SkillMongo,\n      skillMeteor: SkillMeteor\n    };\n    this.tools[1].gameObjectConstructor = objectTypeMap[type];\n  };\n\n  return Toolbar;\n})();\n\nmodule.exports = Toolbar;\n","function ToolManager(props) {\n  this.tools = props.tools;\n  this.mouse = props.mouse;\n  this.canvas = props.canvas;\n  this.toolID = 0;\n  this.setEventHandlersForTool(this.toolID);\n}\n\nObject.defineProperties(ToolManager.prototype, {\n  tool: {\n    get: function() {\n      return this.toolID;\n    },\n    set: function(id) {\n      if (id !== this.toolID) {\n        this.unsetEventHandlersForTool(this.toolID);\n        this.setEventHandlersForTool(id);\n        this.toolID = id;\n      }\n    }\n  }\n});\n\nToolManager.prototype.unsetEventHandlersForTool = function(id) {\n  var entries = Object.entries(this.tools[id].eventHandlers.mouse);\n  for (var i = 0; i < entries.length; i++) {\n    var key = entries[i][0];\n    var value = entries[i][1];\n    this.mouse.off(this.canvas, key, value.handler, value.props);\n  }\n};\n\nToolManager.prototype.setEventHandlersForTool = function(id) {\n  var entries = Object.entries(this.tools[id].eventHandlers.mouse);\n  for (var i = 0; i < entries.length; i++) {\n    var key = entries[i][0];\n    var value = entries[i][1];\n    this.mouse.on(this.canvas, key, value.handler, value.props);\n  }\n};\n\nmodule.exports = ToolManager;\n"],"sourceRoot":""}